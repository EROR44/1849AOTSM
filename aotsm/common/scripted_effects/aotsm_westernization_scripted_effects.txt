##WESTERNIZATION_SCRIPTS

clamp_westernisation_vars = {
    clamp_variable = {
		var = ROOT.aotsm_westernisation_points_num
		min = 0
		max = 100
	}
}

up_westernisation_period = {
    if = {
        limit = {
            has_idea = backward_nation
        }
        swap_ideas = {
            remove_idea = backward_nation
            add_idea = lagging_nation
        }
        set_variable = { ROOT.progress_of_westornisation_frame = 2 }
		set_variable = { ROOT.westornisation_background_frame = 2 }
    }
    else_if = {
        limit = {
            has_idea = lagging_nation
        }
        swap_ideas = {
            remove_idea = lagging_nation
            add_idea = westernizing_nation
        }
        set_variable = { ROOT.progress_of_westornisation_frame = 3 }
		set_variable = { ROOT.westornisation_background_frame = 3 }
    }
    else_if = {
        limit = {
            has_idea = westernizing_nation
        }
        swap_ideas = {
            remove_idea = westernizing_nation
            add_idea = westernisation_end
        }
        set_variable = { ROOT.progress_of_westornisation_frame = 4 }
		set_variable = { ROOT.westornisation_background_frame = 4 }
    }
    set_variable = {
        var = ROOT.aotsm_westernisation_points_num
        value = 0
    }
}

down_westernisation_period = {
    if = {
        limit = {
            has_idea = westernisation_end
        }
        swap_ideas = {
            remove_idea = westernisation_end
            add_idea = westernizing_nation
        }
        set_variable = { ROOT.progress_of_westornisation_frame = 3 }
		set_variable = { ROOT.westornisation_background_frame = 3 }
    }
    else_if = {
        limit = {
            has_idea = westernizing_nation
        }
        swap_ideas = {
            remove_idea = westernizing_nation
            add_idea = lagging_nation
        }
        set_variable = { ROOT.progress_of_westornisation_frame = 2 }
		set_variable = { ROOT.westornisation_background_frame = 2 }
    }
    else_if = {
        limit = {
            has_idea = lagging_nation
        }
        swap_ideas = {
            remove_idea = lagging_nation
            add_idea = backward_nation
        }
        set_variable = { ROOT.progress_of_westornisation_frame = 1 }
		set_variable = { ROOT.westornisation_background_frame = 1 }
    }
    set_variable = {
        var = ROOT.aotsm_westernisation_points_num
        value = 51
    }
}

add_15_point_westernisation = {
    custom_effect_tooltip = add_15_point_westernisation_tt
    add_to_variable = { ROOT.aotsm_westernisation_points_num = 15 }
    force_update_dynamic_modifier = yes
    clamp_westernisation_vars = yes
}

add_10_point_westernisation = {
    custom_effect_tooltip = add_10_point_westernisation_tt
    add_to_variable = { ROOT.aotsm_westernisation_points_num = 10 }
    force_update_dynamic_modifier = yes
    clamp_westernisation_vars = yes
}

add_5_point_westernisation = {
    custom_effect_tooltip = add_5_point_westernisation_tt
    add_to_variable = { ROOT.aotsm_westernisation_points_num = 5 }
    force_update_dynamic_modifier = yes
    clamp_westernisation_vars = yes
}

add_3_point_westernisation = {
    custom_effect_tooltip = add_3_point_westernisation_tt
    add_to_variable = { ROOT.aotsm_westernisation_points_num = 3 }
    force_update_dynamic_modifier = yes
    clamp_westernisation_vars = yes
}

add_1_point_westernisation = {
    custom_effect_tooltip = add_1_point_westernisation_tt
    add_to_variable = { ROOT.aotsm_westernisation_points_num = 1 }
    force_update_dynamic_modifier = yes
    clamp_westernisation_vars = yes
}

remove_15_point_westernisation = {
    custom_effect_tooltip = remove_15_point_westernisation_tt
    subtract_from_variable = { ROOT.aotsm_westernisation_points_num = 15 }
    force_update_dynamic_modifier = yes
    clamp_westernisation_vars = yes
}

remove_10_point_westernisation = {
    custom_effect_tooltip = remove_10_point_westernisation_tt
    subtract_from_variable = { ROOT.aotsm_westernisation_points_num = 10 }
    force_update_dynamic_modifier = yes
    clamp_westernisation_vars = yes
}

remove_5_point_westernisation = {
    custom_effect_tooltip = remove_5_point_westernisation_tt
    subtract_from_variable = { ROOT.aotsm_westernisation_points_num = 5 }
    force_update_dynamic_modifier = yes
    clamp_westernisation_vars = yes
}

remove_3_point_westernisation = {
    custom_effect_tooltip = remove_3_point_westernisation_tt
    subtract_from_variable = { ROOT.aotsm_westernisation_points_num = 3 }
    force_update_dynamic_modifier = yes
    clamp_westernisation_vars = yes
}

remove_1_point_westernisation = {
    custom_effect_tooltip = remove_1_point_westernisation_tt
    subtract_from_variable = { ROOT.aotsm_westernisation_points_num = 1 }
    force_update_dynamic_modifier = yes
    clamp_westernisation_vars = yes
}

add_1_5_10_westernisation_points = {
    if = {
		limit ={
			has_idea = backward_nation
		}
		add_1_point_westernisation = yes
	}
	else_if = {
		limit ={
			has_idea = lagging_nation
		}
		add_5_point_westernisation = yes
	}
	else_if = {
		limit ={
			has_idea = westernizing_nation
		}
		add_10_point_westernisation = yes
	}
}

add_2_5_10_westernisation_points = {
    if = {
		limit ={
			has_idea = backward_nation
		}
		add_2_point_westernisation = yes
	}
	else_if = {
		limit ={
			has_idea = lagging_nation
		}
		add_5_point_westernisation = yes
	}
	else_if = {
		limit ={
			has_idea = westernizing_nation
		}
		add_10_point_westernisation = yes
	}
}

w_check_who_is_protector_power = {
    if = {
        limit = {
            FROM = {
                tag = PRU
            }
        }
        add_1_point_westernisation = yes
        set_country_flag = aotsm_w_country_has_pru_protection
    }
    else_if = {
        limit = {
            FROM = {
                tag = FRR
            }
        }
        add_1_point_westernisation = yes
        set_country_flag = aotsm_w_country_has_frr_protection
    }
    else_if = {
        limit = {
            FROM = {
                tag = CBI
            }
        }
        add_1_point_westernisation = yes
        set_country_flag = aotsm_w_country_has_cbi_protection
    }
    else_if = {
        limit = {
            FROM = {
                tag = AUS
            }
        }
        add_1_point_westernisation = yes
        set_country_flag = aotsm_w_country_has_aus_protection
    }
    else_if = {
        limit = {
            FROM = {
                    tag = BYZ
            }
        }
        add_1_point_westernisation = yes
        set_country_flag = aotsm_w_country_has_byz_protection
    }
    else_if = {
        limit = {
            FROM = {
                tag = RUS
            }
        }
        add_1_point_westernisation = yes
        set_country_flag = aotsm_w_country_has_rus_protection
    }
}

w_check_who_is_refuse_to_protection = {
    if = {
        limit = {
            FROM = {
                tag = PRU
            }
        }
        set_country_flag = aotsm_w_pru_refuse_to_protection
    }
    else_if = {
        limit = {
            FROM = {
                tag = FRR
            }
        }
        set_country_flag = aotsm_w_frr_refuse_to_protection
    }
    else_if = {
        limit = {
            FROM = {
                tag = CBI
            }
        }
        set_country_flag = aotsm_w_cbi_refuse_to_protection
    }
    else_if = {
        limit = {
            FROM = {
                tag = AUS
            }
        }
        set_country_flag = aotsm_w_aus_refuse_to_protection
    }
    else_if = {
        limit = {
            FROM = {
                tag = BYZ
            }
        }
        set_country_flag = aotsm_w_byz_refuse_to_protection
    }
    else_if = {
        limit = {
            FROM = {
                tag = RUS
            }
        }
        set_country_flag = aotsm_w_rus_refuse_to_protection
    }
}

w_add_25_pp_protector_country = {
    if = {
		limit = {
			has_country_flag = aotsm_w_country_has_pru_protection
		}
		PRU = {
			add_political_power = 25
		}
	}
	else_if = {
		limit = {
			has_country_flag = aotsm_w_country_has_frr_protection
		}
		FRR = {
			add_political_power = 25
		}
	}
	else_if = {
		limit = {
			has_country_flag = aotsm_w_country_has_cbi_protection
		}
		CBI = {
				add_political_power = 25
		}
	}
	else_if = {
		limit = {
				has_country_flag = aotsm_w_country_has_aus_protection
		}
		AUS = {
			add_political_power = 25
		}
	}
	else_if = {
		limit = {
			has_country_flag = aotsm_w_country_has_byz_protection
		}
		BYZ = {
			add_political_power = 25
		}
	}
	else_if = {
		limit = {
			has_country_flag = aotsm_w_country_has_rus_protection
		}
		RUS = {
			add_political_power = 25
		}
	}
}

w_get_manpower_to_country_protector = {
    if = {
		limit = {
			has_country_flag = aotsm_w_country_has_pru_protection
		}
        ROOT = {
            add_manpower = -2500
        }
		PRU = {
			add_manpower = 2500
		}
	}
	else_if = {
		limit = {
			has_country_flag = aotsm_w_country_has_frr_protection
		}
        ROOT = {
            add_manpower = -2500
        }
		FRR = {
			add_manpower = 2500
		}
	}
	else_if = {
		limit = {
			has_country_flag = aotsm_w_country_has_cbi_protection
		}
        ROOT = {
            add_manpower = -2500
        }
		CBI = {
			add_manpower = 2500
		}
	}
	else_if = {
		limit = {
				has_country_flag = aotsm_w_country_has_aus_protection
		}
        ROOT = {
            add_manpower = -2500
        }
		AUS = {
			add_manpower = 2500
		}
	}
	else_if = {
		limit = {
			has_country_flag = aotsm_w_country_has_byz_protection
		}
        ROOT = {
            add_manpower = -2500
        }
		BYZ = {
			add_manpower = 2500
		}
	}
	else_if = {
		limit = {
			has_country_flag = aotsm_w_country_has_rus_protection
		}
        ROOT = {
            add_manpower = -2500
        }
		RUS = {
			add_manpower = 2500
		}
	}
}

w_add_ideology_of_country_protector_popularity = {
    if = {
		limit = {
            OR = {
                AND = {
                    has_country_flag = aotsm_w_country_has_pru_protection
                    PRU = { has_government = authoritarian }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_frr_protection
                    FRR = { has_government = authoritarian }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_cbi_protection
                    CBI = { has_government = authoritarian }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_aus_protection
                    AUS = { has_government = authoritarian }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_byz_protection
                    BYZ = { has_government = authoritarian }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_rus_protection
                    RUS = { has_government = authoritarian }
                }
            }
		}
        ROOT = {
            add_popularity = {
				ideology = authoritarian
				popularity = 0.025
			}
        }
	}
	else_if = {
		limit = {
            OR = {
                AND = {
                    has_country_flag = aotsm_w_country_has_pru_protection
                    PRU = { has_government = reactionist }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_frr_protection
                    FRR = { has_government = reactionist }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_cbi_protection
                    CBI = { has_government = reactionist }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_aus_protection
                    AUS = { has_government = reactionist }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_byz_protection
                    BYZ = { has_government = reactionist }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_rus_protection
                    RUS = { has_government = reactionist }
                }
            }
		}
        ROOT = {
            add_popularity = {
				ideology = reactionist
				popularity = 0.025
			}
        }
	}
	else_if = {
		limit = {
            OR = {
                AND = {
                    has_country_flag = aotsm_w_country_has_pru_protection
                    PRU = { has_government = socialism }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_frr_protection
                    FRR = { has_government = socialism }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_cbi_protection
                    CBI = { has_government = socialism }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_aus_protection
                    AUS = { has_government = socialism }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_byz_protection
                    BYZ = { has_government = socialism }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_rus_protection
                    RUS = { has_government = socialism }
                }
            }
		}
        ROOT = {
            add_popularity = {
				ideology = socialism
				popularity = 0.025
			}
        }
	}
	else_if = {
		limit = {
            OR = {
                AND = {
                    has_country_flag = aotsm_w_country_has_pru_protection
                    PRU = { has_government = democratic }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_frr_protection
                    FRR = { has_government = democratic }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_cbi_protection
                    CBI = { has_government = democratic }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_aus_protection
                    AUS = { has_government = democratic }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_byz_protection
                    BYZ = { has_government = democratic }
                }
                AND = {
                    has_country_flag = aotsm_w_country_has_rus_protection
                    RUS = { has_government = democratic }
                }
            }
		}
        ROOT = {
            add_popularity = {
				ideology = democratic
				popularity = 0.025
			}
        }
	}
}