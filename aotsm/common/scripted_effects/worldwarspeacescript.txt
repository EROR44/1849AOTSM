##ANNEXATION AND OTHER SCRIPT IN BIG CONFLICTS AND GREAT WAR

#Victory flag 

set_victory_in_world_war = {
	if = {
		limit = {
			PRU = {
				has_war = no
				has_completed_focus = PRU_first_world_war
			}
			NOT = {
				has_global_flag = pru_capitulation 	
			}
		}
		PRU = {
			set_country_flag = first_world_war_won
		}
	}
	if = {
		limit = {
			BYZ = {
				has_war = no
				has_completed_focus = BYZ_war_come_to_us
			}
			NOT = {
				has_global_flag = byz_capitulation 	
			}
		}
		BYZ = {
			set_country_flag = first_world_war_won
		}
	}
	if = {
		limit = {
			CBI = {
				has_war = no
				has_completed_focus = CBI_great_war
			}
			NOT = {
				has_global_flag = cbi_capitulation 	
			}
		}
		CBI = {
			set_country_flag = first_world_war_won
		}
	}
	if = {
		limit = {
			RUS = {
				has_war = no
				OR = {
					has_completed_focus = RUS_unexpected_prussian_invade
					has_completed_focus = RUS_marh_to_our_enemies
					has_completed_focus = RUS_war_becomes_to_russia
				}
			}
			NOT = {
				has_global_flag = russian_capitulation 	
			}
		}
		RUS = {
			set_country_flag = first_world_war_won
		}
	}
	if = {
		limit = {
			FRR = {
				has_war = no
				has_country_flag = frr_access_to_world_war_flag
			}
			NOT = {
				has_global_flag = france_capitulation 	
			}
		}
		FRR = {
			set_country_flag = first_world_war_won
		}
	}
	if = {
		limit = {
			PRT = {
				has_war = no
				has_country_flag = prt_access_to_world_war_flag
			}
			NOT = {
				has_global_flag = prt_capitulation 	
			}
		}
		PRT = {
			set_country_flag = first_world_war_won
		}
	}
	if = {
		limit = {
			any_country = {
				has_country_flag = first_world_war_won
			}
			NOT = {
				has_global_flag = event_about_world_end_fire
			}
		}
		set_global_flag = event_about_world_end_fire
		if = {
			limit = {
				RUS = {
					has_country_flag = first_world_war_won
				}
				NOT = {
					CBI = {
						has_country_flag = first_world_war_won
					}
				}
				NOT = {
					FRR = {
						has_country_flag = first_world_war_won
					}
				}
				NOT = {
					PRT = {
						has_country_flag = first_world_war_won
					}
				}
			}
			set_global_flag = rus_solo_win_ww
		}
		if = {
			limit = {
				NOT = {
					RUS = {
						has_country_flag = first_world_war_won
					}
				}
				CBI = {
					has_country_flag = first_world_war_won
				}
				NOT = {
					FRR = {
						has_country_flag = first_world_war_won
					}
				}
				NOT = {
					PRT = {
						has_country_flag = first_world_war_won
					}
				}
			}
			set_global_flag = cbi_solo_win_ww
		}
		if = {
			limit = {
				NOT = {
					RUS = {
						has_country_flag = first_world_war_won
					}
				}
				NOT = {
					CBI = {
						has_country_flag = first_world_war_won
					}
				}
				FRR = {
					has_country_flag = first_world_war_won
				}
				NOT = {
					PRT = {
						has_country_flag = first_world_war_won
					}
				}
			}
			set_global_flag = frr_solo_win_ww
		}
		if = {
			limit = {
				NOT = {
					RUS = {
						has_country_flag = first_world_war_won
					}
				}
				NOT = {
					CBI = {
						has_country_flag = first_world_war_won
					}
				}
				NOT = {
					FRR = {
						has_country_flag = first_world_war_won
					}
				}
				PRT = {
					has_country_flag = first_world_war_won
				}
			}
			set_global_flag = prt_solo_win_ww
		}
		if = {
			limit = {
				OR = {
					AND = {
						RUS = {
							has_country_flag = first_world_war_won
						}
						CBI = {
							has_country_flag = first_world_war_won
						}
					}
					AND = {
						RUS = {
							has_country_flag = first_world_war_won
						}
						FRR = {
							has_country_flag = first_world_war_won
						}
					}
					AND = {
						RUS = {
							has_country_flag = first_world_war_won
						}
						PRT = {
							has_country_flag = first_world_war_won
						}
					}
					AND = {
						PRT = {
							has_country_flag = first_world_war_won
						}
						CBI = {
							has_country_flag = first_world_war_won
						}
					}
					AND = {
						PRT = {
							has_country_flag = first_world_war_won
						}
						FRR = {
							has_country_flag = first_world_war_won
						}
					}
					AND = {
						FRR = {
							has_country_flag = first_world_war_won
						}
						CBI = {
							has_country_flag = first_world_war_won
						}
					}
				}
			}
			set_global_flag = lon_pac_win_ww
		}
		if = {
			limit = {
				NOT = {
					BYZ = {
						has_country_flag = first_world_war_won
					}
				}
				PRU = {
					has_country_flag = first_world_war_won
				}
			}
			set_global_flag = pru_solo_win_ww
		}
		if = {
			limit = {
				BYZ = {
					has_country_flag = first_world_war_won
				}
				NOT = {
					PRU = {
						has_country_flag = first_world_war_won
					}
				}
			}
			set_global_flag = byz_solo_win_ww
		}
		if = {
			limit = {
				BYZ = {
					has_country_flag = first_world_war_won
				}
				PRU = {
					has_country_flag = first_world_war_won
				}
			}
			set_global_flag = kon_pac_win_ww
		}
		news_event = {
			id = news.297
			days = 5
		}
	}
}

prussian_capitulation_all = {
	#RUSSIAN#
	if = {
		limit = {
			PRU = {
				has_war_with = RUS
			}
		}
		RUS = {
			transfer_state = 188
		}
		if = {
			limit = {
				country_exists = PLH
			}
			RUS = {
				annex_country = {
					target = PLH
					transfer_troops = no
				}
			}
		}
		if = {
			limit = {
				country_exists = POL
			}
			RUS = {
				annex_country = {
					target = POL
					transfer_troops = no
				}
			}
		}
		if = {
			limit = {
				country_exists = BLT
			}
			RUS = {
				annex_country = {
					target = BLT
					transfer_troops = no
				}
			}
		}
		if = {
			limit = {
				country_exists = WRT
			}
			RUS = {
				annex_country = {
					target = WRT
					transfer_troops = no
				}
			}
		}
		if = {
			limit = {
				country_exists = UKR
			}
			RUS = {
				annex_country = {
					target = UKR
					transfer_troops = no
				}
			}
		}
		if = {
			limit = {
				OR = {
					PRU = {
						owns_state = 9
					}
					OR = {
						BOH = {
							is_subject_of = PRU
							is_puppet_of = PRU
						}
					}
				}
			}
			if = {
				limit = {
					NOT = {
						country_exists = BOH
					}
				}
				BOH = {
					transfer_state = 9
					transfer_state = 69
					transfer_state = 72
					transfer_state = 74
					transfer_state = 75
					transfer_state = 810
				}
			}
			if = {
				limit = {
					country_exists = BOH
				}	
				RUS = {
					set_autonomy = {
						target = BOH
						autonomy_state = autonomy_puppet
						end_wars = yes
						end_civil_wars = yes
					}
				}
				BOH = {
					inherit_technology = RUS
				}
				PRU = {
					transfer_units_fraction= {
						target = BOH
						size = 0.00
						stockpile_ratio = 0.10
						army_ratio = 0.05
						navy_ratio = 0.00
						air_ratio = 0.00
					}
				}
			}
		}
		if = {
			limit = {
				RUS = {
					has_war_with = HUN
				}
			}
			SLA = {
				transfer_state = 70
				transfer_state = 71
				transfer_state = 73
				transfer_state = 664
			}
			GLA = {
				transfer_state = 80
				transfer_state = 88
				transfer_state = 89
				transfer_state = 91
			}
			RUS = {
				set_autonomy = {
					target = SLA
					autonomy_state = autonomy_puppet
					end_wars = yes
					end_civil_wars = yes
				}
			}
			RUS = {
				set_autonomy = {
					target = GLA
					autonomy_state = autonomy_puppet
					end_wars = yes
					end_civil_wars = yes
				}
			}
			PRU = {
				transfer_units_fraction= {
					target = SLA
					size = 0.00
					stockpile_ratio = 0.10
					army_ratio = 0.05
					navy_ratio = 0.00
					air_ratio = 0.00
				}
			}
			SLA = {
				inherit_technology = RUS
			}
			GLA = {
				inherit_technology = RUS
			}
		}
	}
	#RUSSIAN#
	#FRANCE#
	if = {
		limit = {
			PRU = {
				has_war_with = FRR
			}
		}
		FRR = {
			transfer_state = 28
			add_state_core = 28
			transfer_state = 828
			add_state_core = 828
		}
		if = {
			limit = { 
				FRR = { NOT = { has_government = reactionist }}
			}
			REU = {
				transfer_state = 8
				add_state_core = 8
				transfer_state = 42
				add_state_core = 42
				transfer_state = 51
				add_state_core = 51
				transfer_state = 894
				add_state_core = 894
			}
			FRR = {
				set_autonomy = {
					target = REU
					autonomy_state = autonomy_puppet
					end_wars = yes
					end_civil_wars = yes
				}
			}
		}
		if = {
			limit = { 
				FRR = { has_government = reactionist }
			}
			FRR = {
				transfer_state = 8
				add_state_core = 8
				transfer_state = 42
				add_state_core = 42
				transfer_state = 51
				add_state_core = 51
				transfer_state = 894
				add_state_core = 894
			}
		}

		BEL = {
			transfer_state = 6
			add_state_core = 6
			transfer_state = 34
			add_state_core = 863
			transfer_state = 863
			add_state_core = 863
		}
		FRR = {
			set_autonomy = {
				target = BEL
				autonomy_state = autonomy_puppet
				end_wars = yes
				end_civil_wars = yes
			}
		}
		BEL = {
			drop_cosmetic_tag = yes
			if = {
				limit = {
					BEL = {
						has_government = socialism
					}
				}
				BEL = {
					kill_country_leader = yes
				}
			}
		}
	}
	#FRANCE#
	#CONFEDERATION#
	if = {
		limit = {
			PRU = {
				has_war_with = CBI
			}
		}
		PRT = {
			transfer_state = 308
			transfer_state = 695
		}
		CBI = {
			set_autonomy = {
				target = HOL
				autonomy_state = autonomy_puppet
				end_wars = yes
				end_civil_wars = yes
			}
		}
		CBI = {
			set_autonomy = {
				target = IND
				autonomy_state = autonomy_colony
				end_wars = yes
				end_civil_wars = yes
			}
		}
		MAT = {
			set_cosmetic_tag = MAT_MAN
		}
		PRU = {
			set_autonomy = {
				target = MAT
				autonomy_state = autonomy_free
				end_wars = yes
				end_civil_wars = yes
			}
		}
		CBI = {
			add_to_faction = MAT
		}
		MAT = {
			transfer_state = 540
			transfer_state = 769
			transfer_state = 825
			transfer_state = 825
		}
	}
	#CONFEDERATION#
	#BASE#
	AUS = {
		transfer_state = 4
		add_state_core = 4
		transfer_state = 39
		add_state_core = 39
		transfer_state = 152
		add_state_core = 152
		transfer_state = 153
		add_state_core = 153
		transfer_state = 887
		add_state_core = 887
		drop_cosmetic_tag = yes
	}
	PRU = {
		set_autonomy = {
			target = AUS
			autonomy_state = autonomy_free
			end_wars = yes
			end_civil_wars = yes
		}
	}
	if = {
		limit = {
			FRA = {
				owns_state = 16
			}
		}
		if = {
			limit = {
				PRU = {
					owns_state = 28
				}
			}
			FRA = {
				transfer_state = 28
			}
		}
		if = {
			limit = {
				PRU = {
					owns_state = 828
				}
			}
			FRA = {
				transfer_state = 828
			}
		}
		if = {
			limit = {
				PRU = {
					owns_state = 862
				}
			}
			FRA = {
				transfer_state = 862
			}
		}
		if = {
			limit = {
				HOL = {
					owns_state = 861
				}
			}
			FRA = {
				transfer_state = 861
			}
		}
	}
	if = {
		limit = {
			NOT ={
				FRA = {
					owns_state = 16
				}
			}
		}
		if = {
			limit = {
				PRU = {
					owns_state = 8
				}
			}
			REU = {
				transfer_state = 8
			}
		}
		if = {
			limit = {
				PRU = {
					owns_state = 28
				}
			}
			REU = {
				transfer_state = 28
			}
		}
		if = {
			limit = {
				PRU = {
					owns_state = 42
				}
			}
			REU = {
				transfer_state = 42
			}
		}
		if = {
			limit = {
				PRU = {
					owns_state = 51
				}
			}
			REU = {
				transfer_state = 51
			}
		}
		if = {
			limit = {
				PRU = {
					owns_state = 828
				}
			}
			REU = {
				transfer_state = 828
			}
		}
		if = {
			limit = {
				PRU = {
					owns_state = 862
				}
			}
			REU = {
				transfer_state = 862
			}
		}
		if = {
			limit = {
				HOL = {
					owns_state = 861
				}
			}
			BEL = {
				transfer_state = 861
			}
		}
		if = {
			limit = {
				PRU = {
					owns_state = 894
				}
			}
			REU = {
				transfer_state = 894
			}
		}
	}
	if = {
		limit = {
			BEL = {
				is_subject_of = PRU
			}
		}
		BEL = {
			drop_cosmetic_tag = yes
			kill_country_leader = yes
			transfer_state = 6
			transfer_state = 863
		}
		PRU = {
			set_autonomy = {
				target = BEL
				autonomy_state = autonomy_free
				end_wars = yes
				end_civil_wars = yes
			}
		}
	}
	if = {
		limit = {
			PRU = {
				owns_state = 308
			}
		}
		KUB = {
			transfer_state = 308
		}
	}
	if = {
		limit = {
			PRU = {
				owns_state = 691
			}
		}
		KUB = {
			transfer_state = 691
		}
	}
	if = {
		limit = {
			PRU = {
				owns_state = 694
			}
		}
		KUB = {
			transfer_state = 694
		}
	}
	if = {
		limit = {
			PRU = {
				owns_state = 695
			}
		}
		KUB = {
			transfer_state = 695
		}
	}
	if = {
		limit = {
			PRU = {
				owns_state = 299
			}
		}
		MAT = {
			transfer_state = 299
		}
	}
	if = {
		limit = {
			PRU = {
				owns_state = 702
			}
		}
		SEN = {
			transfer_state = 702
		}
	}
	if = {
		limit = {
			PRU = {
				owns_state = 703
			}
		}
		MAT = {
			transfer_state = 703
		}
	}
	if = {
		limit = {
			PRU = {
				owns_state = 704
			}
		}
		MAT = {
			transfer_state = 704
		}
	}
	if = {
		limit = {
			PRU = {
				owns_state = 720
			}
		}
		MAT = {
			transfer_state = 720
		}
	}
	if = {
		limit = {
			MAT = {
				owns_state = 841
			}
		}
		SEN = {
			transfer_state = 841
		}
	}
	if = {
		limit = {
			MAT = {
				owns_state = 847
			}
		}
		SEN = {
			transfer_state = 847
		}
	}
	if = {
		limit = {
			MAT = {
				owns_state = 839
			}
		}
		GWI = {
			transfer_state = 839
		}
	}
	if = {
		limit = {
			MAT = {
				owns_state = 843
			}
		}
		AKA = {
			transfer_state = 843
		}
	}
	if = {
		limit = {
			MAT = {
				owns_state = 844
			}
		}
		AKA = {
			transfer_state = 844
		}
	}
	if = {
		limit = {
			MAT = {
				owns_state = 842
			}
		}
		SOK = {
			transfer_state = 842
		}
	}
	if = {
		limit = {
			PRU = {
				owns_state = 151
			}
		}
		SWI = {
			transfer_state = 151
		}
	}
	if = {
		limit = {
			PRU = {
				owns_state = 661
			}
		}
		SWI = {
			transfer_state = 661
		}
	}
	if = {
		limit = {
			BLT = {
				is_subject_of = PRU
			}
		}
		PRU = {
			set_autonomy = {
				target = BLT
				autonomy_state = autonomy_free
				end_wars = yes
				end_civil_wars = yes
			}
		}
	}
	if = {
		limit = {
			WRT = {
				is_subject_of = PRU
			}
		}
		PRU = {
			set_autonomy = {
				target = WRT
				autonomy_state = autonomy_free
				end_wars = yes
				end_civil_wars = yes
			}
		}
	}
	if = {
		limit = {
			MAT = {
				is_subject_of = PRU
			}
		}
		PRU = {
			set_autonomy = {
				target = MAT
				autonomy_state = autonomy_free
				end_wars = yes
				end_civil_wars = yes
			}
		}
	}
	if = {
		limit = {
			BOH = {
				is_subject_of = PRU
			}
		}
		PRU = {
			set_autonomy = {
				target = BOH
				autonomy_state = autonomy_free
				end_wars = yes
				end_civil_wars = yes
			}
		}
		BOH = {
			drop_cosmetic_tag = yes
			transfer_state = 69
			transfer_state = 810
		}
	}
	if = {
		limit = {
			AUS = {
				is_subject_of = PRU
			}
		}
		PRU = {
			set_autonomy = {
				target = AUS
				autonomy_state = autonomy_free
				end_wars = yes
				end_civil_wars = yes
			}
		}
		AUS = {
			drop_cosmetic_tag = yes
			transfer_state = 887
			add_state_core = 887
		}
	}
	BYZ = {
		leave_faction = yes
		create_faction = PURPLE_DAWN
		add_to_faction = HUN
	}
	every_country = {
		limit = {
			has_war_with = PRU
		}
		white_peace = PRU
	}
	PRU = {
		dismantle_faction = yes
	}
	set_global_flag = pru_capitulation
	news_event = {
		id = news.80
		days = 1
	}
	PRU = {
		country_event = {
			id = postwar.1
			days = 30
		}
	}
	if = {
		limit = {
			NOT = {
				PRU = {
					has_country_flag = revolution_start_pru
				}
			}
		}
		PRU = {
			set_politics = { ruling_party = reactionist elections_allowed = no }
			set_popularities = {
				democratic = 20
				socialism = 0
				reactionist = 51
				authoritarian = 29
			}
			set_cosmetic_tag = PRU_LOSE
		}
		PRU = {
			load_focus_tree = lose_germany_focus
		}
		SGE = {
			load_focus_tree = rev_germany_focus
		}
		PRR = {
			load_focus_tree = prussian_lose_focus
		}
		PRU = {
			if = {
				limit = {
					has_idea = monarchy
				}
				PRU = {
					swap_ideas = {
						remove_idea = monarchy
						add_idea = republic
					}
				}
			}
		}
		PRU = {
			if = {
				limit = {
					has_idea = constitutional_monarchy_fg
				}
				PRU = {
					swap_ideas = {
						remove_idea = constitutional_monarchy_fg
						add_idea = republic
					}
				}
			}
		}
		PRU = {
			if = {
				limit = {
					has_idea = parliament_monarchy
				}
				PRU = {
					swap_ideas = {
						remove_idea = parliament_monarchy
						add_idea = republic
					}
				}
			}
		}
		PRU = {
			if = {
				limit = {
					has_idea = dictature_fg
				}
				PRU = {
					swap_ideas = {
						remove_idea = dictature_fg
						add_idea = republic
					}
				}
			}
		}
		if = {
			limit = {
				PRU = {
					has_idea = world_power
				}
			}
			PRU = {
				swap_ideas = {
					remove_idea = world_power
					add_idea = large_country
				}
			}
		}
		if = {
			limit = {
				PRU = {
					has_idea = potential_world_power
				}
			}
			PRU = {
				swap_ideas = {
					remove_idea = potential_world_power
					add_idea = large_country
				}
			}
		}
		every_country = { 
			limit = {
				has_war_with = PRU
			}
			white_peace = PRU
		}
	}
	set_victory_in_world_war = yes
}

byzanatium_capitulation_all = {
	if = {
		limit = {
			OR = {
				SAR = {
					is_subject_of = BYZ
				}
				BYZ = {
					has_country_flag = byz_save_country_by_sar
				}
			}
		}
		BYZ = {
			annex_country = {
				target = SAR
				transfer_troops = no
			}
			set_capital = {
				state = 2
				remember_old_capital = yes
			}
		}
	}
	if = {
		limit = {
			BYZ = {
				has_war_with = RUS
			}
		}
		RUS = {
			transfer_state = 229
			transfer_state = 230
			transfer_state = 231
			transfer_state = 232
			transfer_state = 233
			transfer_state = 926
			transfer_state = 927
			transfer_state = 928
			transfer_state = 929
			transfer_state = 930
			transfer_state = 931
			transfer_state = 932
			transfer_state = 933
			transfer_state = 934
			transfer_state = 936
			transfer_state = 937
			transfer_state = 938
		}
		RUS = {
			if = {
				limit = {
					country_exists = BCH
				}
				RUS = {
					annex_country = {
						target = BCH
						transfer_troops = no
					}
				}
			}
			if = {
				limit = {
					137 = {
						NOT = { is_core_of = RUS }
					}
				}
				RUS = {
					add_state_core = 137
				}
			}
			if = {
				limit = {
					BYZ = {
						owns_state = 48
					}
				}
				RUS = {
					transfer_state = 48
				}
			}
			if = {
				limit = {
					BYZ = {
						owns_state = 77
					}
				}
				RUS = {
					transfer_state = 77
				}
			}
			if = {
				limit = {
					BYZ = {
						owns_state = 106
					}
				}
				RUS = {
					transfer_state = 106
				}
			}
			if = {
				limit = {
					BYZ = {
						owns_state = 211
					}
				}
				RUS = {
					transfer_state = 211
				}
			}
			if = {
				limit = {
					BYZ = {
						owns_state = 212
					}
				}
				RUS = {
					transfer_state = 212
				}
			}
			if = {
				limit = {
					BYZ = {
						owns_state = 801
					}
				}
				RUS = {
					transfer_state = 801
				}
			}
			if = {
				limit = {
					BYZ = {
						owns_state = 803
					}
				}
				RUS = {
					transfer_state = 803
				}
			}
		}
		ALB = {
			transfer_state = 44
			transfer_state = 805
		}
		RUS = {
			set_autonomy = {
				target = ALB
				autonomy_state = autonomy_puppet
				end_wars = yes
				end_civil_wars = yes
			}
		}
		SER = {
			if = {
				limit = {
					BYZ = {
						owns_state = 105
					}
				}
				SER = {
					transfer_state = 105
				}
			}
			if = {
				limit = {
					BYZ = {
						owns_state = 107
					}
				}
				SER = {
					transfer_state = 107
				}
			}
			if = {
				limit = {
					BYZ = {
						owns_state = 108
					}
				}
				SER = {
					transfer_state = 108
				}
			}
			if = {
				limit = {
					BYZ = {
						owns_state = 802
					}
				}
				SER = {
					transfer_state = 802
				}
			}
			transfer_state = 764
		}
		RUS = {
			set_autonomy = {
				target = SER
				autonomy_state = autonomy_puppet
				end_wars = yes
				end_civil_wars = yes
			}
		}
		CRO = {
			transfer_state = 45
			if = {
				limit = {
					OR = {
						BYZ = {
							owns_state = 103
						}
						DAL = {
							owns_state = 103
						}
					}
				}
				CRO = {
					transfer_state = 103
				}
			}
			if = {
				limit = {
					OR = {
						BYZ = {
							owns_state = 109
						}
						DAL = {
							owns_state = 109
						}
					}
				}
				CRO = {
					transfer_state = 109
				}
			}
			if = {
				limit = {
					OR = {
						BYZ = {
							owns_state = 163
						}
						DAL = {
							owns_state = 163
						}
					}
				}
				CRO = {
					transfer_state = 163
				}
			}
		}
		RUS = {
			set_autonomy = {
				target = CRO
				autonomy_state = autonomy_puppet
				end_wars = yes
				end_civil_wars = yes
			}
		}
		BOS = {
			if = {
				limit = {
					OR = {
						BYZ = {
							owns_state = 104
						}
						DAL = {
							owns_state = 104
						}
					}
				}
				BOS = {
					transfer_state = 104
				}
			}
			if = {
				limit = {
					OR = {
						BYZ = {
							owns_state = 804
						}
						DAL = {
							owns_state = 804
						}
					}
				}
				BOS = {
					transfer_state = 804
				}
			}
		}
		RUS = {
			set_autonomy = {
				target = BOS
				autonomy_state = autonomy_puppet
				end_wars = yes
				end_civil_wars = yes
			}
		}
		SLO = {
			if = {
				limit = {
					OR = {
						BYZ = {
							owns_state = 102
						}
						DAL = {
							owns_state = 102
						}
					}
				}
				SLO = {
					transfer_state = 102
				}
			}
			if = {
				limit = {
					OR = {
						BYZ = {
							owns_state = 736
						}
						DAL = {
							owns_state = 736
						}
					}
				}
				SLO = {
					transfer_state = 736
				}
			}
		}
		RUS = {
			set_autonomy = {
				target = SLO
				autonomy_state = autonomy_puppet
				end_wars = yes
				end_civil_wars = yes
			}
		}
		if = {
			limit = {
				RUS = {
					has_war_with = HUN
				}
			}
			RUS = {
				set_autonomy = {
					target = HUN
					autonomy_state = autonomy_puppet
					end_wars = yes
					end_civil_wars = yes
				}
			}
			RUS = {
				set_autonomy = {
					target = VLH
					autonomy_state = autonomy_puppet
					end_wars = yes
					end_civil_wars = yes
				}
			}
			VLH = {
				transfer_state = 46
				transfer_state = 76
				transfer_state = 79
				transfer_state = 80
				transfer_state = 81
				transfer_state = 82
				transfer_state = 83
				transfer_state = 84
			}
		}
		RUS = {
			transfer_state = 78
			transfer_state = 766
		}
		RUS = {
			transfer_state = 797
			transfer_state = 871
		}
		GRE = {
			transfer_state = 47
			add_state_core = 47
			transfer_state = 164
			add_state_core = 164
			transfer_state = 182
			add_state_core = 182
			transfer_state = 183
			add_state_core = 183
			transfer_state = 184
			add_state_core = 184
			transfer_state = 185
			add_state_core = 185
			transfer_state = 186
			add_state_core = 186
			transfer_state = 187
			add_state_core = 187
			transfer_state = 341
			add_state_core = 341
			transfer_state = 731
			add_state_core = 731
			transfer_state = 817
			add_state_core = 817
		}
		RUS = {
			set_autonomy = {
				target = GRE
				autonomy_state = autonomy_puppet
				end_wars = yes
				end_civil_wars = yes
			}
		}
		TUR = {
			transfer_state = 49
			add_state_core = 49
			transfer_state = 339
			add_state_core = 339
			transfer_state = 340
			add_state_core = 340
			transfer_state = 342
			add_state_core = 342
			transfer_state = 343
			add_state_core = 343
			transfer_state = 344
			add_state_core = 344
			transfer_state = 345
			add_state_core = 345
			transfer_state = 346
			add_state_core = 346
			transfer_state = 347
			add_state_core = 347
			transfer_state = 348
			add_state_core = 348
			transfer_state = 349
			add_state_core = 349
			transfer_state = 353
			add_state_core = 353
			transfer_state = 354
			add_state_core = 354
			transfer_state = 355
			add_state_core = 355
			transfer_state = 356
			add_state_core = 356
			transfer_state = 798
			add_state_core = 798
			transfer_state = 800
			add_state_core = 800
			transfer_state = 913
			add_state_core = 913
			transfer_state = 935
			add_state_core = 935
			transfer_state = 941
			add_state_core = 941
			transfer_state = 942
			add_state_core = 942
			transfer_state = 943
			add_state_core = 943
		}
		RUS = {
			set_autonomy = {
				target = TUR
				autonomy_state = autonomy_puppet
				end_wars = yes
				end_civil_wars = yes
			}
		}
		BYZ = {
			transfer_units_fraction= {
				target = TUR
				size = 0.00
				stockpile_ratio = 0.10
				army_ratio = 0.40
				navy_ratio = 0.25
				air_ratio = 0.25
			}
		}
		BYZ = {
			transfer_units_fraction= {
				target = GRE
				size = 0.00
				stockpile_ratio = 0.10
				army_ratio = 0.25
				navy_ratio = 0.50
				air_ratio = 0.50
			}
		}
	}
	if = {
		limit = {
			has_war_with = CBI
		}
		CBI = {
			annex_country = {
				target = ZUL
				transfer_troops = no
			}
		}
		OIC = {
			annex_country = {
				target = RIT
				transfer_troops = no
			}
		}
		CBI = {
			if = {
				limit = {
					BYZ = {
						owns_state = 118
					}
				}
				CBI = {
					transfer_state = 118
				}
			}
			if = {
				limit = {
					BYZ = {
						owns_state = 869
					}
				}
				CBI = {
					transfer_state = 869
				}
			}
		}
	}
	if = {
		limit = {
			BYZ = {
				has_war_with = FRR
			}
		}
		FRR = {
			transfer_state = 838
		}
		if = {
			limit = {
				OR = {
					SAR = {
						is_subject_of = BYZ
					}
					BYZ = {
						owns_state = 735
					}
				}
			}
			FRR = {
				transfer_state = 735
			}
		}
	}
	BYZ = {
		set_autonomy = {
			target = SYR
			autonomy_state = autonomy_free
			end_wars = yes
			end_civil_wars = yes
		}
	}
	SYR = {
		transfer_state = 799
	}
	BYZ = {
		set_autonomy = {
			target = KUR
			autonomy_state = autonomy_free
			end_wars = yes
			end_civil_wars = yes
		}
	}
	BYZ = {
		set_autonomy = {
			target = CPT
			autonomy_state = autonomy_free
			end_wars = yes
			end_civil_wars = yes
		}
	}
	CPT = {
		transfer_state = 816
	}
	BYZ = {
		set_autonomy = {
			target = RIT
			autonomy_state = autonomy_free
			end_wars = yes
			end_civil_wars = yes
		}
	}
	BYZ = {
		set_autonomy = {
			target = ZUL
			autonomy_state = autonomy_free
			end_wars = yes
			end_civil_wars = yes
		}
	}
	if = {
		limit = {
			country_exists = SOS
			BYZ = {
				owns_state = 832
			}
		}
		SOS = {
			transfer_state = 832
		}
	}
	if = {
		limit = {
			country_exists = SOR
			BYZ = {
				owns_state = 832
			}
		}
		SOR = {
			transfer_state = 832
		}
	}
	if = {
		limit = {
			country_exists = SOS
			BYZ = {
				owns_state = 833
			}
		}
		SOS = {
			transfer_state = 833
		}
	}
	if = {
		limit = {
			BYZ = {
				owns_state = 709
			}
		}
		RIT = {
			transfer_state = 709
		}
	}
	if = {
		limit = {
			BYZ = {
				owns_state = 710
			}
		}
		RIT = {
			transfer_state = 710
		}
	}
	if = {
		limit = {
			BYZ = {
				owns_state = 713
			}
		}
		RIT = {
			transfer_state = 713
		}
	}
	if = {
		limit = {
			country_exists = SOR
			BYZ = {
				owns_state = 833
			}
		}
		SOR = {
			transfer_state = 833
		}
	}
	if = {
		limit = {
			KUK = {
				is_subject_of = BYZ
			}
		}
		BYZ = {
			set_autonomy = {
				target = KUK
				autonomy_state = autonomy_free
				end_wars = yes
				end_civil_wars = yes
			}
		}
	}
	if = {
		limit = {
			BCH = {
				is_subject_of = BYZ
			}
		}
		BYZ = {
			set_autonomy = {
				target = BCH
				autonomy_state = autonomy_free
				end_wars = yes
				end_civil_wars = yes
			}
		}
	}
	if = {
		limit = {
			VLH = {
				is_subject_of = BYZ
			}
		}
		BYZ = {
			set_autonomy = {
				target = VLH
				autonomy_state = autonomy_free
				end_wars = yes
				end_civil_wars = yes
			}
		}
	}
	if = {
		limit = {
			GAL = {
				is_subject_of = BYZ
			}
		}
		BYZ = {
			set_autonomy = {
				target = GAL
				autonomy_state = autonomy_free
				end_wars = yes
				end_civil_wars = yes
			}
		}
	}
	if = {
		limit = {
			SAR = {
				is_subject_of = BYZ
			}
		}
		BYZ = {
			set_autonomy = {
				target = SAR
				autonomy_state = autonomy_free
				end_wars = yes
				end_civil_wars = yes
			}
		}
	}
	if = {
		limit = {
			country_exists = YPS
			YPS = { is_subject_of = BYZ}
		}
		BYZ = {
			set_autonomy = {
				target = YPS
				autonomy_state = autonomy_free
				end_wars = yes
				end_civil_wars = yes
			}
		}
	}
	every_country = {
		limit = {
			has_war_with = BYZ
		}
		white_peace = BYZ
	}
	BYZ = {
		dismantle_faction = yes
	}
	BYZ = {
		leave_faction = yes
	}
	set_global_flag = byz_capitulation
	news_event = {
		id = news.81
		days = 1
	}
	if = {
		limit = {
			country_exists = BYZ
		}
		BYZ = {
			country_event = {
				id = postwar.4
				days = 60
			}
		}
	}
	BYZ = {
		load_focus_tree = romea_lose_focus
	}
	if = {
		limit = {
			BYZ = {
				has_idea = world_power
			}
		}
		BYZ = {
			swap_ideas = {
				remove_idea = world_power
				add_idea = large_country
			}
		}
	}
	if = {
		limit = {
			BYZ = {
				has_idea = potential_world_power
			}
		}
		BYZ = {
			swap_ideas = {
				remove_idea = potential_world_power
				add_idea = large_country
			}
		}
	}
	BYZ = {
		set_country_flag = start_of_fall_byz
	}
	BYZ = {
		country_event = {
			id = script_event.31
			days = 5
		}
	}	
	every_country = { 
		limit = {
			has_war_with = BYZ
		}
		white_peace = BYZ
	}
	set_victory_in_world_war = yes
}

scandinavia_capitulation_all = {
	#Russian
	if = {
		limit = {
			SCA = {
				has_war_with = RUS
			}
		}
		RUS = {
			transfer_state = 124
			transfer_state = 148
		}
	}
	#Britain
	if = {
		limit = {
			SCA = {
				has_war_with = CBI
			}
		}
		CBI = {
			transfer_state = 100
			transfer_state = 101
			transfer_state = 337
		}
		if = {
			limit = {
				country_exists = VIN
			}
			CBI = {
				set_autonomy = {
					target = VIN
					autonomy_state = autonomy_colony
					end_wars = yes
					end_civil_wars = yes
				}
			}
			if = {
				limit = {
					NOT = {
						VIN = {
							owns_state = 276
						}
					}
				}
				VIN = {
					transfer_state = 276
				}
			}
			if = {
				limit = {
					NOT = {
						VIN = {
							owns_state = 464
						}
					}
				}
				VIN = {
					transfer_state = 464
				}
			}
			if = {
				limit = {
					NOT = {
						VIN = {
							owns_state = 465
						}
					}
				}
				VIN = {
					transfer_state = 465
				}
			}
			if = {
				limit = {
					NOT = {
						VIN = {
							owns_state = 468
						}
					}
				}
				VIN = {
					transfer_state = 468
				}
			}
			VIN = {
				set_cosmetic_tag = VIN_CAN
			}
		}
	}
	#BASE
	SWE = {
		transfer_state = 38
		transfer_state = 138
		transfer_state = 139
		transfer_state = 140
		transfer_state = 666
	}
	SWE = { change_tag_from = SCA }
	NOR = {
		transfer_state = 110
		transfer_state = 142
		transfer_state = 143
		transfer_state = 144
	}
	DEN = {
		transfer_state = 37
		transfer_state = 99
	}
	SCA = {
		remove_state_core = 37
		remove_state_core = 38
		remove_state_core = 99
		remove_state_core = 100
		remove_state_core = 101
		remove_state_core = 110
		remove_state_core = 111
		remove_state_core = 124
		remove_state_core = 138
		remove_state_core = 139
		remove_state_core = 140
		remove_state_core = 141
		remove_state_core = 142
		remove_state_core = 143
		remove_state_core = 144
		remove_state_core = 146
		remove_state_core = 147
		remove_state_core = 148
		remove_state_core = 149
		remove_state_core = 213
		remove_state_core = 215
		remove_state_core = 216
		remove_state_core = 337
		remove_state_core = 666
		remove_state_core = 722
	}
	SCA = {
		remove_state_claim = 13
		remove_state_claim = 191
	}
	SCA = {
		transfer_units_fraction= {
			target = SWE
			size = 0.00
			stockpile_ratio = 0.00
			army_ratio = 0.50
			navy_ratio = 0.50
			air_ratio = 0.00
		}
	}
	SCA = {
		transfer_units_fraction= {
			target = NOR
			size = 0.00
			stockpile_ratio = 0.00
			army_ratio = 0.75
			navy_ratio = 0.75
			air_ratio = 0.00
		}
	}
	SCA = {
		transfer_units_fraction= {
			target = DEN
			size = 0.00
			stockpile_ratio = 0.00
			army_ratio = 1.00
			navy_ratio = 1.00
			air_ratio = 0.00
		}
	}
	SWE = {
		inherit_technology = SCA
	}
	NOR = {
		inherit_technology = SCA
	}
	DEN = {
		inherit_technology = SCA
	}
	SWE = {
		transfer_state = 141
	}
	#Britain next
	if = {
		limit = {
			SCA = {
				has_war_with = CBI
			}
		}
		CBI = {
			puppet = NOR
			puppet = DEN
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 100
			}
		}
		DEN = {
			transfer_state = 100
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 101
			}
		}
		DEN = {
			transfer_state = 101
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 58
			}
		}
		DEN = {
			transfer_state = 58
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 337
			}
		}
		DEN = {
			transfer_state = 337
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 829
			}
		}
		DEN = {
			transfer_state = 829
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 124
			}
		}
		SWE = {
			transfer_state = 124
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 111
			}
		}
		FIN = {
			transfer_state = 111
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 146
			}
		}
		FIN = {
			transfer_state = 146
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 147
			}
		}
		FIN = {
			transfer_state = 147
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 149
			}
		}
		FIN = {
			transfer_state = 149
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 150
			}
		}
		FIN = {
			transfer_state = 150
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 213
			}
		}
		FIN = {
			transfer_state = 213
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 215
			}
		}
		FIN = {
			transfer_state = 215
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 216
			}
		}
		FIN = {
			transfer_state = 216
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 722
			}
		}
		FIN = {
			transfer_state = 722
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 148
			}
		}
		if = {
			limit = {
				NOT = {
					country_exists = FIN
				}
			}
			RUS = {
				transfer_state = 148
			}
		}
		if = {
			limit = {
				country_exists = FIN
			}
			FIN = {
				transfer_state = 148
			}
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 111
			}
		}
		RUS = {
			transfer_state = 111
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 145
			}
		}
		RUS = {
			transfer_state = 145
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 146
			}
		}
		RUS = {
			transfer_state = 146
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 147
			}
		}
		RUS = {
			transfer_state = 147
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 149
			}
		}
		RUS = {
			transfer_state = 149
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 150
			}
		}
		RUS = {
			transfer_state = 150
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 213
			}
		}
		RUS = {
			transfer_state = 213
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 215
			}
		}
		RUS = {
			transfer_state = 215
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 216
			}
		}
		RUS = {
			transfer_state = 216
		}
	}
	if = {
		limit = {
			SCA = {
				owns_state = 722
			}
		}
		RUS = {
			transfer_state = 722
		}
	}
	if = {
		limit = {
			SCA = {
				has_war_with = RUS
			}
		}
		RUS = {
			annex_country = {
				target = FIN
				transfer_troops = no
			}
		}
	}
	SCA = {
		leave_faction = yes
	}
	every_country = {
		limit = {
			has_war_with = SCA
		}
		white_peace = SCA
	}
	set_global_flag = sca_capitulation
	news_event = {
		id = news.97
		days = 1
	}
	set_victory_in_world_war = yes
}

japan_capitulation_all = {
	if = {
		limit = {
			OR = {
				JAP = {
					has_war_with = RUS
				}
				JAS = {
					has_war_with = RUS
				}
				TUK = {
					has_war_with = RUS
				}
			}
		}
		RUS = {
			transfer_state = 536
			transfer_state = 537
			transfer_state = 555
			transfer_state = 655
			transfer_state = 745
			if = {
				limit = {
					OR = {
						KJP = {
							is_subject_of = JAP
							is_puppet_of = JAP
						}
						KJP = {
							is_subject_of = JAS
							is_puppet_of = JAS
						}
						KJP = {
							is_subject_of = TUK
							is_puppet_of = TUK
						}
					}
				}
				RUS = {
					puppet = KJP
				}
			}
		}
	}
	if = {
		limit = {
			OR = {
				JAP = {
					has_war_with = CBI
				}
				JAS = {
					has_war_with = CBI
				}
				TUK = {
					has_war_with = CBI
				}
			}
		}
		CBI = {
			transfer_state = 524
			transfer_state = 526
			transfer_state = 528
			transfer_state = 638
			transfer_state = 645
			transfer_state = 646
			transfer_state = 648
			transfer_state = 728
			if = {
				limit = {
					OR = {
						NIS = {
							is_subject_of = JAP
							is_puppet_of = JAP
						}
						NIS = {
							is_subject_of = JAS
							is_puppet_of = JAS
						}
						NIS = {
							is_subject_of = TUK
							is_puppet_of = TUK
						}
					}
				}
				CBI = {
					puppet = NIS
				}
			}
			if = {
				limit = {
					OR = {
						PJP = {
							is_subject_of = JAP
							is_puppet_of = JAP
						}
						PJP = {
							is_subject_of = JAS
							is_puppet_of = JAS
						}
						PJP = {
							is_subject_of = TUK
							is_puppet_of = TUK
						}
					}
				}
				CBI = {
					puppet = PJP
				}
			}
		}
	}
	if = {
		limit = {
			OR = {
				JAP = {
					has_war_with = FRR
				}
				JAS = {
					has_war_with = FRR
				}
				TUK = {
					has_war_with = FRR
				}
			}
		}
		FRR = {
			if = {
				limit = {
					OR = {
						JIA = {
							is_subject_of = JAP
							is_puppet_of = JAP
						}
						JIA = {
							is_subject_of = JAS
							is_puppet_of = JAS
						}
						JIA = {
							is_subject_of = TUK
							is_puppet_of = TUK
						}
					}
				}
				FRR = {
					puppet = JIA
				}
			}
		}
	}
	if = {
		limit = {
			OR = {
				KJP = {
					is_subject_of = JAP
					is_puppet_of = JAP
				}
				KJP = {
					is_subject_of = JAS
					is_puppet_of = JAS
				}
				KJP = {
					is_subject_of = TUK
					is_puppet_of = TUK
				}
			}
		}
		if = {
			limit = {
				country_exists = JAP
			}
			JAP = {
				set_autonomy = {
					target = KJP
					autonomy_state = autonomy_free
					end_wars = no
					end_civil_wars = no
				}
			}
		}
		if = {
			limit = {
				country_exists = JAS
			}
			JAS = {
				set_autonomy = {
					target = KJP
					autonomy_state = autonomy_free
					end_wars = no
					end_civil_wars = no
				}
			}
		}
		if = {
			limit = {
				country_exists = TUK
			}
			TUK = {
				set_autonomy = {
					target = KJP
					autonomy_state = autonomy_free
					end_wars = no
					end_civil_wars = no
				}
			}
		}	
	}
	if = {
		limit = {
			OR = {
				PJP = {
					is_subject_of = JAP
					is_puppet_of = JAP
				}
				PJP = {
					is_subject_of = JAS
					is_puppet_of = JAS
				}
				PJP = {
					is_subject_of = TUK
					is_puppet_of = TUK
				}
			}
		}
		if = {
			limit = {
				country_exists = JAP
			}
			JAP = {
				set_autonomy = {
					target = PJP
					autonomy_state = autonomy_free
					end_wars = no
					end_civil_wars = no
				}
			}
		}
		if = {
			limit = {
				country_exists = JAS
			}
			JAS = {
				set_autonomy = {
					target = PJP
					autonomy_state = autonomy_free
					end_wars = no
					end_civil_wars = no
				}
			}
		}
		if = {
			limit = {
				country_exists = TUK
			}
			TUK = {
				set_autonomy = {
					target = PJP
					autonomy_state = autonomy_free
					end_wars = no
					end_civil_wars = no
				}
			}
		}
	}
	if = {
		limit = {
			OR = {
				JIA = {
					is_subject_of = JAP
					is_puppet_of = JAP
				}
				JIA = {
					is_subject_of = JAS
					is_puppet_of = JAS
				}
				JIA = {
					is_subject_of = TUK
					is_puppet_of = TUK
				}
			}
		}
		if = {
			limit = {
				country_exists = JAP
			}
			JAP = {
				set_autonomy = {
					target = JIA
					autonomy_state = autonomy_free
					end_wars = no
					end_civil_wars = no
				}
			}
		}
		if = {
			limit = {
				country_exists = JAS
			}
			JAS = {
				set_autonomy = {
					target = JIA
					autonomy_state = autonomy_free
					end_wars = no
					end_civil_wars = no
				}
			}
		}
		if = {
			limit = {
				country_exists = TUK
			}
			TUK = {
				set_autonomy = {
					target = JIA
					autonomy_state = autonomy_free
					end_wars = no
					end_civil_wars = no
				}
			}
		}
	}
	if = {
		limit = {
			OR = {
				NIS = {
					is_subject_of = JAP
					is_puppet_of = JAP
				}
				NIS = {
					is_subject_of = JAS
					is_puppet_of = JAS
				}
				NIS = {
					is_subject_of = TUK
					is_puppet_of = TUK
				}
			}
		}
		if = {
			limit = {
				country_exists = JAP
			}
			JAP = {
				set_autonomy = {
					target = NIS
					autonomy_state = autonomy_free
					end_wars = no
					end_civil_wars = no
				}
			}
		}
		if = {
			limit = {
				country_exists = JAS
			}
			JAS = {
				set_autonomy = {
					target = NIS
					autonomy_state = autonomy_free
					end_wars = no
					end_civil_wars = no
				}
			}
		}
		if = {
			limit = {
				country_exists = TUK
			}
			TUK = {
				set_autonomy = {
					target = NIS
					autonomy_state = autonomy_free
					end_wars = no
					end_civil_wars = no
				}
			}
		}
	}
	if = {
		limit = {
			country_exists = JAP
		}
		JAP = {
			leave_faction = yes
		}
		every_country = {
			limit = {
				has_war_with = JAP
			}
			white_peace = JAP
		}
	}
	if = {
		limit = {
			country_exists = JAS
		}
		JAS = {
			leave_faction = yes
		}
		every_country = {
			limit = {
				has_war_with = JAS
			}
			white_peace = JAS
		}
	}
	if = {
		limit = {
			country_exists = TUK
		}
		TUK = {
			leave_faction = yes
		}
		every_country = {
			limit = {
				has_war_with = TUK
			}
			white_peace = TUK
		}
	}
	set_global_flag = jap_capitulation
}

cbi_capitulation_all = {
	#Holland
	if = {
		limit = {
			CBI = {
				has_war_with = IND
			}
		}
		IND = {
			transfer_state = 711
		}
	}
	#Prussia
	if = {
		limit = {
			MAT = {
				OR = {
					is_puppet_of = PRU
					is_subject_of = PRU
				}
			}
			CBI = {
				has_war_with = PRU
			}
		}
		MAT = {
			transfer_state = 826
			add_state_core = 826
			transfer_state = 841
			add_state_core = 841
			transfer_state = 842
			add_state_core = 842
			transfer_state = 843
			add_state_core = 843
			transfer_state = 844
			add_state_core = 844
		}
	}
	if = {
		limit = {
			NOT = {
				MAT = {
					OR = {
						is_puppet_of = PRU
						is_subject_of = PRU
					}
				}
			}
			CBI = {
				has_war_with = PRU
			}
		}
		PRU = {
			transfer_state = 826
			transfer_state = 841
			transfer_state = 842
			transfer_state = 843
			transfer_state = 844
		}
	}
	if = {
		limit = {
			CBI = {
				has_war_with = PRU
			}
		}
		CBI = {
			set_autonomy = {
				target = IRE
				autonomy_state = autonomy_free
				end_wars = no
				end_civil_wars = no
			}
		}
		IRE = {
			leave_faction = yes
			remove_ideas = CBI_free_irland
		}
		if = {
			limit = {
				NOT = {
					country_exists = IRE
				}
			}
			if = {
				limit = {
					113 = {
						owner = {
							OR = {
								tag = CBI
								is_subject_of = CBI
								is_in_faction_with = CBI
							}
						}
					}
				}
				IRE = {
					transfer_state = 113
					add_state_core = 113
				}
				CBI = {
					remove_state_core = 113
				}
			}
			if = {
				limit = {
					119 = {
						owner = {
							OR = {
								tag = CBI
								is_subject_of = CBI
								is_in_faction_with = CBI
							}
						}
					}
				}
				IRE = {
					transfer_state = 119
					add_state_core = 119
				}
				CBI = {
					remove_state_core = 119
				}
			}
			if = {
				limit = {
					134 = {
						owner = {
							OR = {
								tag = CBI
								is_subject_of = CBI
								is_in_faction_with = CBI
							}
						}
					}
				}
				IRE = {
					transfer_state = 134
					add_state_core = 134
				}
				CBI = {
					remove_state_core = 134
				}
			}
			if = {
				limit = {
					135 = {
						owner = {
							OR = {
								tag = CBI
								is_subject_of = CBI
								is_in_faction_with = CBI
							}
						}
					}
				}
				IRE = {
					transfer_state = 135
					add_state_core = 135
				}
				CBI = {
					remove_state_core = 135
				}
			}
		}
		if = {
			limit = {
				NOT = {
					IRE = {
						controls_state = 119
					}
				}
			}
			IRE = {
				transfer_state = 119
				add_state_core = 119
			}
			CBI = {
				remove_state_core = 119
			}
		}
		every_country = {
			limit = {
				has_war_with = IRE
			}
			white_peace = IRE
		}
		IRE = {
			set_politics = {
				ruling_party = reactionist
				elections_allowed = no
				last_election = "1854.5.15"
				election_frequency = 48
			}
			add_popularity = {
				ideology = reactionist
				popularity = 0.10
			}
			set_party_name = {
				ideology = reactionist
				long_name = IRE_reactionist_party_free_long
				name = IRE_reactionist_party_free
			}
		}
		PRU = {
			add_to_faction = IRE
		}
		CBI = {
			remove_state_core = 113
			remove_state_core = 119
			remove_state_core = 134
			remove_state_core = 135
		}
		PRU = {
			transfer_state = 299
			transfer_state = 696
			transfer_state = 703
			transfer_state = 704
		}
	}
	#Byzantium
	if = {
		limit = {
			CBI = {
				has_war_with = BYZ
			}
		}
		BYZ = {
			transfer_state = 709
			transfer_state = 710
		}
		BYZ = {
			if = {
				limit = {
					CBI = {
						owns_state = 681
					}
				}
			}
			ZUL = {
				transfer_state = 681
				add_state_core = 681
			}
			if = {
				limit = {
					SAB = {
						OR = {
							is_subject_of = CBI
							is_puppet_of = CBI
						}
					}
				}
				set_autonomy = {
					target = SAB
					autonomy_state = autonomy_aotsm_protectorat
					end_wars = yes
					end_civil_wars = yes
				}
				set_nationality = {
					target_country = SAB
					character = BYZ_Konstantinos_Mavromichalis
				}
				SAB = {
					set_politics = { ruling_party = authoritarian elections_allowed = no }
					set_popularities = {
						democratic = 20
						socialism = 3
						reactionist = 21
						authoritarian = 56
					}
					add_country_leader_role = {
						character = BYZ_Konstantinos_Mavromichalis
						promote_leader = yes
						country_leader = {
							ideology = unirtarism
							expire = "1900.1.1.1"
							traits = { roman_lord }
						}
					}
					set_cosmetic_tag = SAB_BYZ
				}
			}
		}
		RIT = {
			annex_country = {
				target = OIC
				transfer_troops = no
			}
		}
	}
	#Scandinavia
	if = {
		limit = {
			CBI = {
				has_war_with = SCA
			}
			NOT = {
				VIN = {
					has_country_flag = vin_new_land
				}
			}
		}
		VIN = { 
			transfer_state = 276 
			transfer_state = 464
			transfer_state = 465
			transfer_state = 468
		}
		VIN = {
			set_country_flag = vin_new_land
		}
	}
	#Japan
	if = {
		limit = {
			CBI = {
				has_war_with = JAP
			}
			country_exists  = JAP
		}
		JAP = {
			transfer_state = 630
			transfer_state = 632
			transfer_state = 633
			transfer_state = 634
			transfer_state = 635
			transfer_state = 643
			transfer_state = 726
			transfer_state = 727
			set_autonomy = {
				target = BAS
				autonomy_state = autonomy_occupationzone
				end_wars = yes
				end_civil_wars = yes
			}
		}
	}
	if = {
		limit = {
			CBI = {
				has_war_with = JAS
			}
			country_exists  = JAS
		}
		JAS = {
			transfer_state = 630
			transfer_state = 632
			transfer_state = 633
			transfer_state = 634
			transfer_state = 635
			transfer_state = 643
			transfer_state = 726
			transfer_state = 727
			set_autonomy = {
				target = BAS
				autonomy_state = autonomy_occupationzone
				end_wars = yes
				end_civil_wars = yes
			}
		}
	}
	if = {
		limit = {
			CBI = {
				has_war_with = TUK
			}
			country_exists  = TUK
		}
		TUK = {
			transfer_state = 630
			transfer_state = 632
			transfer_state = 633
			transfer_state = 634
			transfer_state = 635
			transfer_state = 643
			transfer_state = 726
			transfer_state = 727
			set_autonomy = {
				target = BAS
				autonomy_state = autonomy_occupationzone
				end_wars = yes
				end_civil_wars = yes
			}
		}
	}
	#BASE
	CBI = {
		set_autonomy = {
			target = NEN
			autonomy_state = autonomy_free
			end_wars = yes
			end_civil_wars = yes
		}
	}
	NEN = {
		leave_faction = yes
	}
	NEN = {
		every_country = {
			limit = {
				has_war_with = NEN
			}
			white_peace = NEN
		}
		transfer_state = 696
		set_cosmetic_tag = NEN_FREE
		promote_character = NEN_Abraham_Lincoln
		set_party_name = {
			ideology = democratic
			long_name = NEN_democratic_party_free_long
			name = NEN_democratic_party_free
		}
		set_party_name = {
			ideology = authoritarian
			long_name = NEN_authoritarian_party_free_long
			name = NEN_authoritarian_party_free
		}
		swap_ideas = {
			remove_idea = oligarhy
			add_idea = republic
		}
		if = {
			limit = {
				date > 1849.1.1
				date < 1850.12.31
			}
			set_politics = {
				ruling_party = democratic
				elections_allowed = no
				last_election = "1849.11.10"
			}
			NEN = {
				set_country_flag = nen_election_1853
				country_event = {
					id = nen.5
					days = 1460
				}
			}
		}
		if = {
			limit = {
				date > 1851.1.1
				date < 1852.12.31
			}
			set_politics = {
				ruling_party = democratic
				elections_allowed = no
				last_election = "1850.11.10"
			}
			NEN = {
				set_country_flag = nen_election_1854
				country_event = {
					id = nen.5
					days = 1460
				}
			}
		}
		if = {
			limit = {
				date > 1852.1.1
				date < 1852.12.31
			}
			set_politics = {
				ruling_party = democratic
				elections_allowed = no
				last_election = "1851.11.10"
			}
			NEN = {
				set_country_flag = nen_election_1855
				country_event = {
					id = nen.5
					days = 1460
				}
			}
		}
		if = {
			limit = {
				date > 1853.1.1
				date < 1853.12.31
			}
			set_politics = {
				ruling_party = democratic
				elections_allowed = no
				last_election = "1852.11.10"
			}
			NEN = {
				set_country_flag = nen_election_1856
				country_event = {
					id = nen.5
					days = 1460
				}
			}
		}
		if = {
			limit = {
				date > 1854.1.1
				date < 1854.12.31
			}
			set_politics = {
				ruling_party = democratic
				elections_allowed = no
				last_election = "1853.11.10"
			}
			NEN = {
				set_country_flag = nen_election_1857
				country_event = {
					id = nen.5
					days = 1460
				}
			}
		}
		if = {
			limit = {
				date > 1855.1.1
				date < 1855.12.31
			}
			set_politics = {
				ruling_party = democratic
				elections_allowed = no
				last_election = "1854.11.10"
			}
			NEN = {
				set_country_flag = nen_election_1858
				country_event = {
					id = nen.5
					days = 1460
				}
			}
		}
		if = {
			limit = {
				date > 1856.1.1
				date < 1856.12.31
			}
			set_politics = {
				ruling_party = democratic
				elections_allowed = no
				last_election = "1855.11.10"
			}
			NEN = {
				set_country_flag = nen_election_1859
				country_event = {
					id = nen.5
					days = 1460
				}
			}
		}
		if = {
			limit = {
				date > 1857.1.1
				date < 1857.12.31
			}
			set_politics = {
				ruling_party = democratic
				elections_allowed = no
				last_election = "1856.11.10"
			}
			NEN = {
				set_country_flag = nen_election_1860
				country_event = {
					id = nen.5
					days = 1460
				}
			}
		}
		if = {
			limit = {
				date > 1858.1.1
				date < 1858.12.31
			}
			set_politics = {
				ruling_party = democratic
				elections_allowed = no
				last_election = "1857.11.10"
			}
			NEN = {
				set_country_flag = nen_election_1861
				country_event = {
					id = nen.5
					days = 1460
				}
			}
		}
		if = {
			limit = {
				date > 1859.1.1
				date < 1859.12.31
			}
			set_politics = {
				ruling_party = democratic
				elections_allowed = no
				last_election = "1858.11.10"
			}
			NEN = {
				set_country_flag = nen_election_1862
				country_event = {
					id = nen.5
					days = 1460
				}
			}
		}
		if = {
			limit = {
				date > 1860.1.1
				date < 1860.12.31
			}
			set_politics = {
				ruling_party = democratic
				elections_allowed = no
				last_election = "1859.11.10"
			}
			NEN = {
				set_country_flag = nen_election_1863
				country_event = {
					id = nen.5
					days = 1460
				}
			}
		}
		if = {
			limit = {
				date > 1861.1.1
				date < 1861.12.31
			}
			set_politics = {
				ruling_party = democratic
				elections_allowed = no
				last_election = "1860.11.10"
			}
			NEN = {
				set_country_flag = nen_election_1864
				country_event = {
					id = nen.5
					days = 1460
				}
			}
		}
	}
	news_event = {
		id = news.254
		days = 10
	}
	if = {
		limit = {
			NOT = {
				OR = {
					AND = {
						CBI = {
							has_war_with = JAP
						}
						country_exists = JAP
					}
					AND = {
						CBI = {
							has_war_with = JAS
						}
						country_exists = JAS
					}
					AND = {
						CBI = {
							has_war_with = TUK
						}
						country_exists = TUK
					}
				}
			}
		}
		CBI = {
			set_autonomy = {
				target = BAS
				autonomy_state = autonomy_free
				end_wars = yes
				end_civil_wars = yes
			}
		}
		BAS = {
			every_country = {
				limit = {
					has_war_with = BAS
				}
				white_peace = BAS
			}
		}
		BAS = {
			leave_faction = yes
		}
	}
	if = {
		limit = {
			NOT = {
				has_global_flag = prt_capitulation
			}
		}
		PRT = {
			set_faction_leader = yes
		}
	}
	CBI = {
		transfer_units_fraction= {
			target = PRU
			size = 0.0
			stockpile_ratio = 0.0
			army_ratio = 0.0
			navy_ratio = 0.85
			air_ratio = 0.0
		}
	}
	MEN = {
		transfer_state = 866
	}
	CBI = {
		transfer_units_fraction= {
			target = MEN
			size = 0.0
			stockpile_ratio = 0.0
			army_ratio = 0.90
			navy_ratio = 0.0
			air_ratio = 0.0
		}
		annex_country = {
			target = MEN
			transfer_troops = no
		}
	}
	if = {
		limit = {
			country_exists = BRI
			BRI = {
				OR = {
					is_puppet_of = CBI
					is_subject_of = CBI
				}
			}
		}
		CBI = {
			annex_country = {
				target = BRI
				transfer_troops = no
			}
		}
	}
	if = {
		limit = {
			country_exists = WAL
			WAL = {
				OR = {
					is_puppet_of = CBI
					is_subject_of = CBI
				}
			}
		}
		CBI = {
			annex_country = {
				target = WAL
				transfer_troops = no
			}
		}
	}
	if = {
		limit = {
			country_exists = SCO
			SCO = {
				OR = {
					is_puppet_of = CBI
					is_subject_of = CBI
				}
			}
		}
		CBI = {
			annex_country = {
				target = SCO
				transfer_troops = no
			}
		}
	}
	CBI = {
		add_manpower = -1000000
	}
	if = {
		limit = {
			CBI = {
				has_idea = scraping_the_barrel
			}
		}
		swap_ideas = {
			remove_idea = scraping_the_barrel
			add_idea = disarmed_nation
		}
	}
	if = {
		limit = {
			CBI = {
				has_idea = all_adults_serve
			}
		}
		swap_ideas = {
			remove_idea = all_adults_serve
			add_idea = disarmed_nation
		}
	}
	if = {
		limit = {
			CBI = {
				has_idea = service_by_requirement
			}
		}
		swap_ideas = {
			remove_idea = service_by_requirement
			add_idea = disarmed_nation
		}
	}
	if = {
		limit = {
			CBI = {
				has_idea = extensive_conscription
			}
		}
		swap_ideas = {
			remove_idea = extensive_conscription
			add_idea = disarmed_nation
		}
	}
	if = {
		limit = {
			CBI = {
				has_idea = limited_conscription
			}
		}
		swap_ideas = {
			remove_idea = limited_conscription
			add_idea = disarmed_nation
		}
	}
	if = {
		limit = {
			CBI = {
				has_idea = volunteer_only
			}
		}
		swap_ideas = {
			remove_idea = volunteer_only
			add_idea = disarmed_nation
		}
	}
	if = {
		limit = {
			OR = {
				NOT = {
					country_exists = IRE
				}
				IRE = {
					OR = {
						is_puppet_of = CBI
						is_subject_of = CBI
					}
				}
			}
		}
		CBI = {
			set_autonomy = {
				target = IRE
				autonomy_state = autonomy_free
				end_wars = no
				end_civil_wars = no
			}
		}
		IRE = {
			leave_faction = yes
			remove_ideas = CBI_free_irland
		}
		if = {
			limit = {
				NOT = {
					country_exists = IRE
				}
			}
			if = {
				limit = {
					113 = {
						owner = {
							OR = {
								tag = CBI
								is_subject_of = CBI
								is_in_faction_with = CBI
							}
						}
					}
				}
				IRE = {
					transfer_state = 113
					add_state_core = 113
				}
				CBI = {
					remove_state_core = 113
				}
			}
			if = {
				limit = {
					119 = {
						owner = {
							OR = {
								tag = CBI
								is_subject_of = CBI
								is_in_faction_with = CBI
							}
						}
					}
				}
				IRE = {
					transfer_state = 119
					add_state_core = 119
				}
				CBI = {
					remove_state_core = 119
				}
			}
			if = {
				limit = {
					134 = {
						owner = {
							OR = {
								tag = CBI
								is_subject_of = CBI
								is_in_faction_with = CBI
							}
						}
					}
				}
				IRE = {
					transfer_state = 134
					add_state_core = 134
				}
				CBI = {
					remove_state_core = 134
				}
			}
			if = {
				limit = {
					135 = {
						owner = {
							OR = {
								tag = CBI
								is_subject_of = CBI
								is_in_faction_with = CBI
							}
						}
					}
				}
				IRE = {
					transfer_state = 135
					add_state_core = 135
				}
				CBI = {
					remove_state_core = 135
				}
			}
		}
		if = {
			limit = {
				NOT = {
					IRE = {
						controls_state = 119
					}
				}
			}
			IRE = {
				transfer_state = 119
				add_state_core = 119
			}
			CBI = {
				remove_state_core = 119
			}
		}
		every_country = {
			limit = {
				has_war_with = IRE
			}
			white_peace = IRE
		}
		IRE = {
			set_politics = {
				ruling_party = reactionist
				elections_allowed = no
				last_election = "1854.5.15"
				election_frequency = 48
			}
			add_popularity = {
				ideology = reactionist
				popularity = 0.10
			}
			set_party_name = {
				ideology = reactionist
				long_name = IRE_reactionist_party_free_long
				name = IRE_reactionist_party_free
			}
		}
		CBI = {
			remove_state_core = 113
			remove_state_core = 119
			remove_state_core = 134
			remove_state_core = 135
		}
	}
	CBI = {
		add_war_support = -2.00
	}
	CBI = {
		leave_faction = yes
	}
	CBI = {
		every_country = {
			limit = {
				has_war_with = CBI
			}
			white_peace = CBI
		}
	}
	set_global_flag = cbi_capitulation
	set_global_flag = NEN_IS_FREE_FROM_BRITISH
	if = {
		limit = {
			NOT = {
				has_global_flag = leypoldit_bombing
			}
		}
		news_event = {
			id = news.77
			days = 1
		}
	}
	set_victory_in_world_war = yes
}

prt_capitulation_all = {
	#Prussia
	if = {
		limit = {
			PRT = {
				has_war_with = PRU
			}
		}
		if = {
			limit = {
				MAT = {
					is_puppet_of = PRU
				}
			}
			MAT = {
				transfer_state = 540
				add_state_core = 540
				transfer_state = 796
				add_state_core = 796
				transfer_state = 825
				add_state_core = 825
				transfer_state = 839
				add_state_core = 839
				transfer_state = 847
				add_state_core = 847
			}
		}
		if = {
			limit = {
				NOT = {
					MAT = {
						is_puppet_of = PRU
					}
				}
			}
			PRU = {
				transfer_state = 540
				transfer_state = 796
				transfer_state = 825
				transfer_state = 839
				transfer_state = 847
			}
		}
		PRU = {
			transfer_state = 691
			transfer_state = 694
			transfer_state = 702
		}
	}
	#Byzantium
	if = {
		limit = {
			PRT = {
				has_war_with = BYZ
			}
		}
		BYZ = {
			transfer_state = 712
		}
		ZUL = {
			transfer_state = 846
			transfer_state = 850
		}
	}
	#Holland
	if = {
		limit = {
			PRT = {
				has_war_with = IND
			}
		}
		IND = {
			transfer_state = 712
			transfer_state = 721
		}
	}
	#Japan
	if = {
		limit = {
			OR = {
				PRT = {
					has_war_with = JAP
				}
				PRT = {
					has_war_with = JAS
				}
				PRT = {
					has_war_with = TUK
				}
			}
		}
		if = {
			limit = {
				PRT = {
					has_war_with = JAP
				}
			}
			JAP = {
				transfer_state = 270
				transfer_state = 629
				transfer_state = 630
				transfer_state = 631
				transfer_state = 636
				transfer_state = 649
				transfer_state = 725
				transfer_state = 734
				transfer_state = 737
				set_autonomy = {
					target = PAS
					autonomy_state = autonomy_occupationzone
					end_wars = yes
					end_civil_wars = yes
				}
			}
			NIS = {
				annex_country = {
					target = SON
					transfer_troops = no
				}
			}
		}
		if = {
			limit = {
				PRT = {
					has_war_with = JAS
				}
			}
			JAS = {
				transfer_state = 270
				transfer_state = 629
				transfer_state = 630
				transfer_state = 631
				transfer_state = 636
				transfer_state = 649
				transfer_state = 725
				transfer_state = 734
				transfer_state = 737
				set_autonomy = {
					target = PAS
					autonomy_state = autonomy_occupationzone
					end_wars = yes
					end_civil_wars = yes
				}
			}
			NIS = {
				annex_country = {
					target = SON
					transfer_troops = no
				}
			}
		}
		if = {
			limit = {
				PRT = {
					has_war_with = TUK
				}
			}
			TUK = {
				transfer_state = 270
				transfer_state = 629
				transfer_state = 630
				transfer_state = 631
				transfer_state = 636
				transfer_state = 649
				transfer_state = 725
				transfer_state = 734
				transfer_state = 737
				set_autonomy = {
					target = PAS
					autonomy_state = autonomy_occupationzone
					end_wars = yes
					end_civil_wars = yes
				}
			}
			NIS = {
				annex_country = {
					target = SON
					transfer_troops = no
				}
			}
		}
	}
	#BASE
	if = {
		limit = {
			NOT = {
				OR = {
					PRT = {
						has_war_with = JAP
					}
					PRT = {
						has_war_with = JAS
					}
					PRT = {
						has_war_with = TUK
					}
				}
			}
		}
		PRT = {
			set_autonomy = {
				target = PAS
				autonomy_state = autonomy_free
				end_wars = yes
				end_civil_wars = yes
			}
		}
		PAS = {
			leave_faction = yes
		}
		every_country = {
			limit = {
				has_war_with = PAS
			}
			white_peace = PAS
		}
	}
	PRT = {
		leave_faction = yes
	}
	PRT = {
		every_country = {
			limit = {
				has_war_with = PRT
			}
			white_peace = PRT
		}
	}
	set_global_flag = prt_capitulation
	if = {
		limit = {
			has_global_flag = leypoldit_bombing
		}
	}
	if = {
		limit = {
			NOT = {
				has_global_flag = leypoldit_bombing
			}
		}
		news_event = {
			id = news.78
			days = 1
		}
	}
	set_victory_in_world_war = yes
}

rus_capitulation_all = {
	RUS = {
		load_focus_tree = empty_rus_tree
	}
	#if = { #в коде 2 Герцена, надо подумать, как прописать свап и цепочки.
	#	limit = {
	#		has_country_leader = {
	#			character = RUS_Aleksander_Ivanovich_Gertsen
	#			ruling_only = yes
	#		}
	#	}
	#	set_nationality = {
	#		target_country = ALS
	#		character = RUS_Aleksander_Ivanovich_Gertsen
	#	}
	#}
	gw_create_poland_effect = yes #эффект выделения Польши, если она не существует
	if = {
		limit = {
			NOT = {
				country_exists = BLT
			}
		}
		BLT = {
			add_state_core = 915
			transfer_state = 11
			transfer_state = 12
			transfer_state = 13
			transfer_state = 189
			transfer_state = 190
			transfer_state = 191
			transfer_state = 784
			transfer_state = 915
		}
		EST = {
			add_state_core = 13
			add_state_core = 191
		}
		LAT = {
			add_state_core = 12
			add_state_core = 190
			add_state_core = 915
		}
		LIT = {
			add_state_core = 11
			add_state_core = 189
			add_state_core = 784
		}
		hidden_effect = {
			PRU = {
				set_autonomy = {
					target = BLT
					autonomy_state = autonomy_integrated_puppet
					end_wars = yes
					end_civil_wars = yes
				}
			}
			BLT = {
				set_politics = { ruling_party = democratic elections_allowed = no }
				set_popularities = {
					democratic = 34
					socialism = 0
					reactionist = 33
					authoritarian = 33
				}
			}
			BLT = {
				load_oob = BLT_army
			}
			BLT = {
				inherit_technology = PRU
			}
			EST = {
				inherit_technology = RUS
			}
			LIT = {
				inherit_technology = RUS
			}
			LAT = {
				inherit_technology = RUS
			}
		}
	}
	if = {
		limit = {
			NOT = {
				country_exists = WRT
			}
		}
		WRT = {
			transfer_state = 94
			add_state_core = 94
			transfer_state = 95
			add_state_core = 95
			transfer_state = 96
			add_state_core = 96
			transfer_state = 194
			add_state_core = 194
			transfer_state = 204
			add_state_core = 204
			transfer_state = 206
			add_state_core = 206
			transfer_state = 207
			add_state_core = 207
			transfer_state = 224
			add_state_core = 224
			transfer_state = 241
			add_state_core = 241
			transfer_state = 243
			add_state_core = 243
			transfer_state = 823
			add_state_core = 823
		}
		hidden_effect = {
			PRU = {
				set_autonomy = {
					target = WRT
					autonomy_state = autonomy_dominion
					end_wars = yes
					end_civil_wars = yes
				}
			}
			WRT = {
				set_politics = { ruling_party = democratic elections_allowed = no }
				set_popularities = {
					democratic = 63
					socialism = 7
					reactionist = 24
					authoritarian = 6
				}
			}
			WRT = {
				load_oob = WRT_army
			}
			WRT = {
				inherit_technology = PRU
			}
		}
	}
	if = {
		limit = {
			NOT = {
				country_exists = UKR
			}
			NOT = {
				has_global_flag = pru_steal_ukraina
			}
		}
		UKR = {
			transfer_state = 93
			add_state_core = 93
			add_state_core = 137
			transfer_state = 192
			add_state_core = 192
			transfer_state = 193
			add_state_core = 193
			add_state_core = 196
			transfer_state = 197
			add_state_core = 197
			transfer_state = 198
			add_state_core = 198
			transfer_state = 199
			add_state_core = 199
			add_state_core = 200
			transfer_state = 201
			add_state_core = 201
			transfer_state = 202
			add_state_core = 202
			transfer_state = 203
			add_state_core = 203
			transfer_state = 220
			add_state_core = 220
			transfer_state = 221
			add_state_core = 221
			transfer_state = 225
			add_state_core = 225
			transfer_state = 226
			add_state_core = 226
			add_state_core = 227
			transfer_state = 228
			add_state_core = 228
			transfer_state = 240
			add_state_core = 240
			transfer_state = 259
			add_state_core = 259
			transfer_state = 859
			add_state_core = 859
			transfer_state = 885
			add_state_core = 885
			transfer_state = 886
			add_state_core = 886
		}
		hidden_effect = {
			PRU = {
				add_to_faction = UKR
			}
			UKR = {
				set_politics = { ruling_party = reactionist elections_allowed = no }
				set_popularities = {
					democratic = 6
					socialism = 1
					reactionist = 84
					authoritarian = 9
				}
			}
			UKR = {
				load_oob = UKR_army
			}
			UKR = {
				inherit_technology = PRU
			}
		}
		if = {
			limit = {
				country_exists = WUK
			}
			WUK = {
				transfer_state = 93
				add_state_core = 93
				transfer_state = 192
				add_state_core = 192
				transfer_state = 198
				add_state_core = 198
				transfer_state = 199
				add_state_core = 199
				transfer_state = 201
				add_state_core = 201
				transfer_state = 885
				add_state_core = 885
			}
			if = {
				limit = {
					NOT = {
						WUK = {
							is_puppet_of = PRU
						}
						WUK = {
							is_subject_of = PRU
						}
					}
				}
				PRU = {
					set_autonomy = {
						target = WUK
						autonomy_state = autonomy_puppet
						end_wars = yes
						end_civil_wars = yes
					}
				}
				WUK = {
					set_politics = { ruling_party = reactionist elections_allowed = no }
					set_popularities = {
						democratic = 13
						socialism = 2
						reactionist = 43
						authoritarian = 42
					}
				}
			}
		}
	}
	if = {
		limit = {
			OR = {
				BYZ = {
					is_in_faction_with = PRU
				}
				BYZ = {
					has_war_with = RUS
				}
			}
		}
		BCH = {
			transfer_state = 137
			add_state_core = 137
			transfer_state = 196
			add_state_core = 196
			transfer_state = 200
			add_state_core = 200
			transfer_state = 218
			add_state_core = 218
			transfer_state = 227
			add_state_core = 227
			transfer_state = 234
			add_state_core = 234
		}
		hidden_effect = {
			BYZ = {
				set_autonomy = {
					target = BCH
					autonomy_state = autonomy_aotsm_province
					end_wars = yes
					end_civil_wars = yes
				}
			}
			BCH = {
				set_politics = { ruling_party = reactionist elections_allowed = no }
				set_popularities = {
					democratic = 3
					socialism = 1
					reactionist = 77
					authoritarian = 19
				}
			}
			BCH = {
				load_oob = BCH_army
			}
			BCH = {
				inherit_technology = BYZ
			}
		}
		KUK = {
			transfer_state = 217
			add_state_core = 217
			transfer_state = 235
			add_state_core = 235
			transfer_state = 236
			add_state_core = 236
			transfer_state = 237
			add_state_core = 237
			transfer_state = 238
			add_state_core = 238
			transfer_state = 245
			add_state_core = 245
			transfer_state = 858
			add_state_core = 858
		}
		hidden_effect = {
			BYZ = {
				set_autonomy = {
					target = KUK
					autonomy_state = autonomy_aotsm_protectorat
					end_wars = yes
					end_civil_wars = yes
				}
			}
			KUK = {
				set_politics = { ruling_party = reactionist elections_allowed = no }
				set_popularities = {
					democratic = 18
					socialism = 1
					reactionist = 62
					authoritarian = 19
				}
			}
			KUK = {
				load_oob = KUK_army
			}
			KUK = {
				inherit_technology = BYZ
			}
		}
	}
	RUS = {
		remove_state_core = 10
		remove_state_core = 11
		remove_state_core = 12
		remove_state_core = 13
		remove_state_core = 87
		remove_state_core = 90
		remove_state_core = 92
		remove_state_core = 93
		remove_state_core = 94
		remove_state_core = 95
		remove_state_core = 96
		remove_state_core = 97
		remove_state_core = 98
		remove_state_core = 137
		remove_state_core = 189
		remove_state_core = 190
		remove_state_core = 191
		remove_state_core = 192
		remove_state_core = 193
		remove_state_core = 194
		remove_state_core = 196
		remove_state_core = 197
		remove_state_core = 198
		remove_state_core = 199
		remove_state_core = 200
		remove_state_core = 201
		remove_state_core = 202
		remove_state_core = 203
		remove_state_core = 204
		remove_state_core = 206
		remove_state_core = 207
		remove_state_core = 217
		remove_state_core = 218
		remove_state_core = 221
		remove_state_core = 225
		remove_state_core = 226
		remove_state_core = 227
		remove_state_core = 228
		remove_state_core = 234
		remove_state_core = 235
		remove_state_core = 236
		remove_state_core = 237
		remove_state_core = 238
		remove_state_core = 241
		remove_state_core = 245
		remove_state_core = 259
		remove_state_core = 784
		remove_state_core = 823
		remove_state_core = 858
		remove_state_core = 885
		remove_state_core = 886
		remove_state_core = 915
	}
	if = {
		limit = {
			AND = {
				SCA = {
					has_country_flag = SCA_VS_RUS_2
				}
				SCA = {
					is_in_faction_with = PRU
				}
				SCA = {
					has_war_with = RUS
				}	
			}
		}
		SCA = {
			transfer_state = 111
			transfer_state = 145
			transfer_state = 146
			transfer_state = 147
			transfer_state = 149
			transfer_state = 150
			transfer_state = 213
			transfer_state = 215
			transfer_state = 216
			transfer_state = 722
		}
		if = {
			limit = {
				RUS = {
					owns_state = 148
				}
			}
			SCA = {
				transfer_state = 148
			}
		}
		RUS = {
			remove_state_core = 213
			remove_state_core = 215
			remove_state_core = 216
			remove_state_core = 722
		}
	}
	if = { #заглушка на случай участия Казахстана в великой войне на стороне России
		limit = {
			KAZ = { 
				is_in_faction_with = RUS
			}
		}
		every_country = {
			limit = {
				has_war_with = KAZ
			}
			white_peace = KAZ
		}
	}				
	RUS = {
		leave_faction = yes
	}
	every_country = {
		limit = {
			has_war_with = RUS
		}
		white_peace = RUS
	}
	every_country = {
		limit = {
			is_in_faction_with = RUS
			has_war_with = PRU
		}
		white_peace = PRU
	}
	every_country = {
		limit = {
			is_in_faction_with = RUS
			has_war_with = BYZ
		}
		white_peace = BYZ
	}
	hidden_effect = {
		if = {
			limit = {
				BYZ = {
					has_idea = russian_history_enemy_1
				}
			}
			BYZ = {
				remove_ideas = russian_history_enemy_1
			}
		}
		if = {
			limit = {
				BYZ = {
					has_idea = russian_history_enemy_2
				}
			}
			BYZ = {
				remove_ideas = russian_history_enemy_2
			}
		}
		if = {
			limit = {
				BYZ = {
					has_idea = russian_history_enemy_3
				}
			}
			BYZ = {
				remove_ideas = russian_history_enemy_3
			}
		}
	}
	set_global_flag = russian_capitulation
	news_event = {
		id = news.76
		days = 1
	}
	if = {
		limit = {
			NOT = {
				RUS = {
					has_country_flag = second_time_of_trouble
				}
			}
		}
		RUS = {
			set_country_flag = second_time_of_trouble
			country_event = {
				id = chain.11
				days = 43
				random_days = 13
			}
		}
	}
	set_victory_in_world_war = yes
}

rus_capitulation_from_ultimatum = { #Понять в чем разница между обычной капитуляцией
	if = {
		limit = {
			NOT = {
				country_exists = POL
			}
		}
		PLH = {
			if = {
				limit = {
					RUS = {
						owns_state = 10
					}
				}
				transfer_state = 10
				RUS = {
					remove_state_core = 10
				}
			}
			if = {
				limit = {
					RUS = {
						owns_state = 87
					}
				}
				transfer_state = 87
				RUS = {
					remove_state_core = 87
				}
			}
			if = {
				limit = {
					RUS = {
						owns_state = 90
					}
				}
				transfer_state = 90
				RUS = {
					remove_state_core = 90
				}
			}
			if = {
				limit = {
					RUS = {
						owns_state = 92
					}
				}
				transfer_state = 92
				RUS = {
					remove_state_core = 92
				}
			}
			if = {
				limit = {
					RUS = {
						owns_state = 97
					}
				}
				transfer_state = 97
				RUS = {
					remove_state_core = 97
				}
			}
			if = {
				limit = {
					RUS = {
						owns_state = 98
					}
				}
				transfer_state = 98
				RUS = {
					remove_state_core = 98
				}
			}
			if = {
				limit = {
					RUS = {
						owns_state = 853
					}
				}
				transfer_state = 853
				RUS = {
					remove_state_core = 853
				}
			}
		}
	}
	if = {
		limit = {
			NOT = {
				country_exists = BLT
			}
		}
		BLT = {
			add_state_core = 915
			transfer_state = 11
			transfer_state = 12
			transfer_state = 13
			transfer_state = 189
			transfer_state = 190
			transfer_state = 191
			transfer_state = 784
			transfer_state = 915
		}
		EST = {
			add_state_core = 13
			add_state_core = 191
		}
		LAT = {
			add_state_core = 12
			add_state_core = 190
			add_state_core = 915
		}
		LIT = {
			add_state_core = 11
			add_state_core = 189
			add_state_core = 784
		}
		hidden_effect = {
			PRU = {
				set_autonomy = {
					target = BLT
					autonomy_state = autonomy_integrated_puppet
					end_wars = yes
					end_civil_wars = yes
				}
			}
			BLT = {
				set_politics = { ruling_party = democratic elections_allowed = no }
				set_popularities = {
					democratic = 34
					socialism = 0
					reactionist = 33
					authoritarian = 33
				}
			}
			BLT = {
				load_oob = BLT_army
			}
			EST = {
				inherit_technology = RUS
			}
			LIT = {
				inherit_technology = RUS
			}
			LAT = {
				inherit_technology = RUS
			}
			BLT = {
				inherit_technology = PRU
			}
		}
	}
	if = {
		limit = {
			NOT = {
				country_exists = WRT
			}
		}
		WRT = {
			transfer_state = 94
			add_state_core = 94
			transfer_state = 95
			add_state_core = 95
			transfer_state = 96
			add_state_core = 96
			transfer_state = 194
			add_state_core = 194
			transfer_state = 204
			add_state_core = 204
			transfer_state = 206
			add_state_core = 206
			transfer_state = 207
			add_state_core = 207
			transfer_state = 224
			add_state_core = 224
			transfer_state = 241
			add_state_core = 241
			transfer_state = 243
			add_state_core = 243
			transfer_state = 823
			add_state_core = 823
		}
		hidden_effect = {
			PRU = {
				set_autonomy = {
					target = WRT
					autonomy_state = autonomy_dominion
					end_wars = yes
					end_civil_wars = yes
				}
			}
			WRT = {
				set_politics = { ruling_party = democratic elections_allowed = no }
				set_popularities = {
					democratic = 63
					socialism = 7
					reactionist = 24
					authoritarian = 6
				}
			}
			WRT = {
				load_oob = WRT_army
			}
			WRT = {
				inherit_technology = PRU
			}
		}
	}
	if = {
		limit = {
			NOT = {
				country_exists = UKR
			}
			NOT = {
				has_global_flag = pru_steal_ukraina
			}
		}
		UKR = {
			transfer_state = 93
			add_state_core = 93
			add_state_core = 137
			transfer_state = 192
			add_state_core = 192
			transfer_state = 193
			add_state_core = 193
			add_state_core = 196
			transfer_state = 197
			add_state_core = 197
			transfer_state = 198
			add_state_core = 198
			transfer_state = 199
			add_state_core = 199
			add_state_core = 200
			transfer_state = 201
			add_state_core = 201
			transfer_state = 202
			add_state_core = 202
			transfer_state = 203
			add_state_core = 203
			transfer_state = 220
			add_state_core = 220
			transfer_state = 221
			add_state_core = 221
			transfer_state = 225
			add_state_core = 225
			transfer_state = 226
			add_state_core = 226
			add_state_core = 227
			transfer_state = 228
			add_state_core = 228
			transfer_state = 240
			add_state_core = 240
			transfer_state = 259
			add_state_core = 259
			transfer_state = 859
			add_state_core = 859
			transfer_state = 885
			add_state_core = 885
			transfer_state = 886
			add_state_core = 886
		}
		hidden_effect = {
			PRU = {
				add_to_faction = UKR
			}
			UKR = {
				set_politics = { ruling_party = reactionist elections_allowed = no }
				set_popularities = {
					democratic = 6
					socialism = 1
					reactionist = 84
					authoritarian = 9
				}
			}
			UKR = {
				load_oob = UKR_army
			}
			UKR = {
				inherit_technology = PRU
			}
		}
		if = {
			limit = {
				country_exists = WUK
			}
			WUK = {
				transfer_state = 93
				add_state_core = 93
				transfer_state = 192
				add_state_core = 192
				transfer_state = 198
				add_state_core = 198
				transfer_state = 199
				add_state_core = 199
				transfer_state = 201
				add_state_core = 201
				transfer_state = 885
				add_state_core = 885
			}
			if = {
				limit = {
					NOT = {
						WUK = {
							is_puppet_of = PRU
						}
						WUK = {
							is_subject_of = PRU
						}
					}
				}
				PRU = {
					set_autonomy = {
						target = WUK
						autonomy_state = autonomy_puppet
						end_wars = yes
						end_civil_wars = yes
					}
				}
				WUK = {
					set_politics = { ruling_party = reactionist elections_allowed = no }
					set_popularities = {
						democratic = 13
						socialism = 2
						reactionist = 43
						authoritarian = 42
					}
				}
			}
		}
	}
	if = {
		limit = {
			BYZ = {
				is_in_faction_with = PRU
			}
		}
		RUS = {
			remove_unit_leader  = 927
		}
		EUK = {
			transfer_state = 221
			add_state_core = 221
			transfer_state = 226
			add_state_core = 226
			transfer_state = 228
			add_state_core = 228
			transfer_state = 240
			add_state_core = 240
		}
		BYZ = {
			set_autonomy = {
				target = EUK
				autonomy_state = autonomy_puppet
				end_wars = yes
				end_civil_wars = yes
			}
		}
		EUK = {
			set_politics = { ruling_party = authoritarian elections_allowed = no }
			set_popularities = {
				democratic = 7
				socialism = 3
				reactionist = 39
				authoritarian = 51
			}
		}
	}
	if = {
		limit = {
			OR = {
				BYZ = {
					is_in_faction_with = PRU
				}
				BYZ = {
					has_war_with = RUS
				}
			}
		}
		if = {
			limit = {
				NOT = {
					country_exists = BCH
				}
			}
			BCH = {
				transfer_state = 137
				add_state_core = 137
				transfer_state = 196
				add_state_core = 196
				transfer_state = 200
				add_state_core = 200
				transfer_state = 218
				add_state_core = 218
				transfer_state = 227
				add_state_core = 227
				transfer_state = 234
				add_state_core = 234
			}
			hidden_effect = {
				BYZ = {
					set_autonomy = {
						target = BCH
						autonomy_state = autonomy_aotsm_province
						end_wars = yes
						end_civil_wars = yes
					}
				}
				BCH = {
					set_politics = { ruling_party = reactionist elections_allowed = no }
					set_popularities = {
						democratic = 3
						socialism = 1
						reactionist = 77
						authoritarian = 19
					}
				}
				BCH = {
					load_oob = BCH_army
				}
				BCH = {
					inherit_technology = BYZ
				}
			}
		}
		if = {
			limit = {
				country_exists = BCH 
			}
			BCH = {
				if = {
					limit = {
						RUS = {
							owns_state = 137
						}
					}
					transfer_state = 137
					RUS = {
						remove_state_core = 137
					}
				}
				if = {
					limit = {
						RUS = {
							owns_state = 196
						}
					}
					transfer_state = 196
					RUS = {
						remove_state_core = 196
					}
				}
				if = {
					limit = {
						RUS = {
							owns_state = 200
						}
					}
					transfer_state = 200
					RUS = {
						remove_state_core = 200
					}
				}
				if = {
					limit = {
						RUS = {
							owns_state = 218
						}
					}
					transfer_state = 218
					RUS = {
						remove_state_core = 218
					}
				}
				if = {
					limit = {
						RUS = {
							owns_state = 227
						}
					}
					transfer_state = 227
					RUS = {
						remove_state_core = 227
					}
				}
				if = {
					limit = {
						RUS = {
							owns_state = 234
						}
					}
					transfer_state = 234
					RUS = {
						remove_state_core = 234
					}
				}
			}
		}
		KUK = {
			transfer_state = 217
			add_state_core = 217
			transfer_state = 235
			add_state_core = 235
			transfer_state = 236
			add_state_core = 236
			transfer_state = 237
			add_state_core = 237
			transfer_state = 238
			add_state_core = 238
			transfer_state = 245
			add_state_core = 245
			transfer_state = 858
			add_state_core = 858
		}
		hidden_effect = {
			BYZ = {
				set_autonomy = {
					target = KUK
					autonomy_state = autonomy_aotsm_protectorat
					end_wars = yes
					end_civil_wars = yes
				}
			}
			KUK = {
				set_politics = { ruling_party = reactionist elections_allowed = no }
				set_popularities = {
					democratic = 18
					socialism = 1
					reactionist = 62
					authoritarian = 19
				}
			}
			KUK = {
				load_oob = KUK_army
			}
			KUK = {
				inherit_technology = BYZ
			}
		}
	}
	RUS = {
		remove_state_core = 10
		remove_state_core = 11
		remove_state_core = 12
		remove_state_core = 13
		remove_state_core = 87
		remove_state_core = 90
		remove_state_core = 92
		remove_state_core = 93
		remove_state_core = 94
		remove_state_core = 95
		remove_state_core = 96
		remove_state_core = 97
		remove_state_core = 98
		remove_state_core = 137
		remove_state_core = 189
		remove_state_core = 190
		remove_state_core = 191
		remove_state_core = 192
		remove_state_core = 193
		remove_state_core = 194
		remove_state_core = 196
		remove_state_core = 197
		remove_state_core = 198
		remove_state_core = 199
		remove_state_core = 200
		remove_state_core = 201
		remove_state_core = 202
		remove_state_core = 203
		remove_state_core = 204
		remove_state_core = 206
		remove_state_core = 207
		remove_state_core = 217
		remove_state_core = 218
		remove_state_core = 221
		remove_state_core = 225
		remove_state_core = 226
		remove_state_core = 227
		remove_state_core = 228
		remove_state_core = 234
		remove_state_core = 235
		remove_state_core = 236
		remove_state_core = 237
		remove_state_core = 238
		remove_state_core = 241
		remove_state_core = 245
		remove_state_core = 259
		remove_state_core = 784
		remove_state_core = 823
		remove_state_core = 858
		remove_state_core = 885
		remove_state_core = 886
		remove_state_core = 915
	}
	if = {
		limit = {
			AND = {
				SCA = {
					has_country_flag = SCA_VS_RUS_2
				}
				SCA = {
					is_in_faction_with = PRU
				}
				SCA = {
					has_war_with = RUS
				}	
			}
		}
		SCA = {
			transfer_state = 111
			transfer_state = 145
			transfer_state = 146
			transfer_state = 147
			transfer_state = 149
			transfer_state = 150
			transfer_state = 213
			transfer_state = 215
			transfer_state = 216
			transfer_state = 722
		}
		RUS = {
			remove_state_core = 213
			remove_state_core = 215
			remove_state_core = 216
			remove_state_core = 722
		}
	}	
	RUS = {
		leave_faction = yes
	}		
	every_country = {
		limit = {
			has_war_with = RUS
		}
		white_peace = RUS
	}
	hidden_effect = {
		if = {
			limit = {
				BYZ = {
					has_idea = russian_history_enemy_1
				}
			}
			BYZ = {
				remove_ideas = russian_history_enemy_1
			}
		}
		if = {
			limit = {
				BYZ = {
					has_idea = russian_history_enemy_2
				}
			}
			BYZ = {
				remove_ideas = russian_history_enemy_2
			}
		}
		if = {
			limit = {
				BYZ = {
					has_idea = russian_history_enemy_3
				}
			}
			BYZ = {
				remove_ideas = russian_history_enemy_3
			}
		}
	}
	set_global_flag = russian_capitulation
	hidden_effect = {
		RUS = {
			set_country_flag = second_time_of_trouble
			country_event = {
				id = chain.11
				days = 43
				random_days = 21
			}
		}
	}
	news_event = {
		id = news.76
		days = 1
	}
	set_victory_in_world_war = yes
}

gw_create_poland_effect = { #выделение Польши при проебе Рашки в ВВ 
 
	if = {
		limit = {
			NOT = {
				country_exists = POL
			}
		}
		PLH = {
			if = {
				limit = {
					RUS = {
						owns_state = 10
					}
				}
				transfer_state = 10
				RUS = {
					remove_state_core = 10
				}
			}
			if = {
				limit = {
					RUS = {
						owns_state = 87
					}
				}
				transfer_state = 87
				RUS = {
					remove_state_core = 87
				}
			}
			if = {
				limit = {
					RUS = {
						owns_state = 90
					}
				}
				transfer_state = 90
				RUS = {
						remove_state_core = 90
				}
			}
			if = {
				limit = {
					RUS = {
						owns_state = 92
					}
				}
				transfer_state = 92
				RUS = {
					remove_state_core = 92
				}
			}
			if = {
				limit = {
					RUS = {
						owns_state = 97
					}
				}
				transfer_state = 97
				RUS = {
					remove_state_core = 97
				}
			}
			if = {
				limit = {
					RUS = {
						owns_state = 98
					}
				}
				transfer_state = 98
				RUS = {
					remove_state_core = 98
				}
			}
			if = {
				limit = {
					RUS = {
						owns_state = 853
					}
				}
				transfer_state = 853
				RUS = {
					remove_state_core = 853
				}
			}
			if = { #на всякий случай - Краков - если он под Россией
				limit = {
					RUS = {
						owns_state = 903
					}
				}
				transfer_state = 903
				RUS = {
					remove_state_core = 903
				}
			}
			if = { #на всякий случай - Краков - если он существует
				limit = {
					country_exists = KRA
				}
				annex_country = {
					target = KRA
					transfer_troops = yes
				}
			}
		}
	}
}